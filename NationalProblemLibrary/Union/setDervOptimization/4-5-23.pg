## DESCRIPTION
## Calculus
## ENDDESCRIPTION

## KEYWORDS('derivative' 'extrema' 'optimization')
## Tagged by tda2d

## DBsubject('Calculus')
## DBchapter('Applications of Differentiation')
## DBsection('Maximum and Minimum Values')
## Date('')
## Author('')
## Institution('Union College')
## TitleText1('')
## EditionText1('')
## AuthorText1('')
## Section1('')
## Problem1('')
## TitleText2('Calculus: Early Transcendentals')
## EditionText2('1')
## AuthorText2('Rogawski')
## Section2('4.2')
## Problem2('15')

DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
   "PG.pl",
   "PGbasicmacros.pl",
   "PGchoicemacros.pl",
   "PGanswermacros.pl",
   "PGauxiliaryFunctions.pl",
   "PGunion.pl",        # Union College utilities
   "PGcourse.pl",       # Customization file for the course
   "alignedChoice.pl",  # for aligned answer blanks
);

TEXT(beginproblem());
BEGIN_PROBLEM();

$at = non_zero_random(-4,4,2);
$a = $at + 5;
$b = 10-$a;
$c0 = random(2,12,1);
$c1 = -3*$a*$b;
$c2 = 3*($b-$a)/2;
$p1 = -$b -1;
$p2 = -$b + 2;
$p3 = $a - 1;
$p4 = $a + 1;

# Compute the answers
$ans1 = -($b**3) + $c2*$b**2 - $c1*$b + $c0;
if ($p1**3 + $c2*$p1**2 + $c1*$p1 < 0)
{
    $ans2 = $p1**3 + $c2*$p1**2 + $c1*$p1 + $c0;
}
else
{
    $ans2 = $c0;
}

if ($p2**3 + $c2*$p2**2 + $c1*$p2 < $p4**3 + $c2*$p4**2 + $c1*$p4)
{
    $ans3 = $p4**3 + $c2*$p4**2 + $c1*$p4 + $c0;
}
else
{
    $ans3 = $p2**3 + $c2*$p2**2 + $c1*$p2 + $c0;
}
$ans4 = ($a**3) + $c2*$a**2 + $c1*$a + $c0;

if ($p4**3 + $c2*$p4**2 + $c1*$p4 < (-$b)**3 + $c2*$b**2 - $c1*$b)
{
    $ans5 = (-$b)**3 + $c2*$b**2 - $c1*$b + $c0;
}
else
{
    $ans5 = $p4**3 + $c2*$p4**2 + $c1*$p4 + $c0;
}
if ($p1**3 + $c2*$p1**2 + $c1*$p1 > ($a)**3 + $c2*$a**2 + $c1*$a)
{
    $ans6 = ($a)**3 + $c2*$a**2 + $c1*$a + $c0;
}
else
{
    $ans6 = $p1**3 + $c2*$p1**2 + $c1*$p1 + $c0;
}

$a1 = new_aligned_list(ans_rule_len=>10, tex_spacing=>"3pt", align =>"LEFT");
$a1->qa(
  "Absolute maximum", num_cmp($ans1),
  "Absolute minimum", num_cmp($ans2),
);

$a2 = new_aligned_list(ans_rule_len=>10, tex_spacing=>"3pt", align =>"LEFT");
$a2->qa(
  "Absolute maximum", num_cmp($ans3),
  "Absolute minimum", num_cmp($ans4),
);

$a3 = new_aligned_list(ans_rule_len=>10, tex_spacing=>"3pt", align =>"LEFT");
$a3->qa(
  "Absolute maximum", num_cmp($ans5),
  "Absolute minimum", num_cmp($ans6),
);

$fstr = FPOLY("x^3+${c2}x^2+${c1}x+$c0");

BEGIN_TEXT
Find the absolute maximum and absolute minimum values of  the function
\[  f(x) = $fstr \]
over each of the indicated intervals.
$PAR
(a) Interval = \([$p1, 0]\).
\{$a1->print_q\}
$BR
(b) Interval = \([$p2, $p4]\).
\{$a2->print_q\}
$BR
(c) Interval = \([$p1, $p4]\).
\{$a3->print_q\}
END_TEXT

$showPartialCorrectAnswers = 1;

ANS($a1->correct_ans);
ANS($a2->correct_ans);
ANS($a3->correct_ans);

END_PROBLEM();
ENDDOCUMENT();        # This should be the last executable line in the problem.

