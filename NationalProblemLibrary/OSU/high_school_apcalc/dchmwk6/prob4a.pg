#DESCRIPTION
#KEYWORDS('derivatives', 'related rates')
#TYPE('word problem')
# Related rates -- conical tank
#Authored by Zig Fiedorowicz - June 2001
#ENDDESCRIPTION

DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl"
);

$a = random(2,7,1);
$b = random(10,17,1);
$c = random(7,14,1);
$d = random(2,$b-3,1);
$pi = 4*atan2(1,1);

$ans1 = "$a*h/$b";
$ans2 = "$pi*$a**2*h**3/(3*$b**2)";
$ans3 = $c*$pi;
$ans4 = $ans3*$b**2/($pi*$a**2*$d**2);

TEXT(&beginproblem);
BEGIN_TEXT
Water is flowing into a conical tank at \($c\pi\) cubic feet per hour.
The height of the tank is $b feet and its radius (at the top) is $a feet.
How fast is the depth of water in the tank rising when the water in the
tank is $d feet deep?

\setlength{\unitlength}{0.5in}
\begin{picture}(4.5,3.5)(-2.5,0)
\thicklines
\put(-1,3){\line(1,-3){1}}
\put(0,0){\line(1,3){1}}
\put(-1,3){\line(1,0){2}}
\put(-.5,1.5){\line(1,0){1}}
\thinlines
\put(-0.48,1.44){\line(1,0){0.96}}
\put(-0.46,1.38){\line(1,0){0.92}}
\put(-0.44,1.32){\line(1,0){0.88}}
\put(-0.42,1.26){\line(1,0){0.84}}
\put(-0.4,1.2){\line(1,0){0.8}}
\put(-0.38,1.14){\line(1,0){0.76}}
\put(-0.36,1.08){\line(1,0){0.72}}
\put(-0.34,1.02){\line(1,0){0.68}}
\put(-0.32,0.96){\line(1,0){0.64}}
\put(-0.3,0.9){\line(1,0){0.6}}
\put(-0.28,0.84){\line(1,0){0.56}}
\put(-0.26,0.78){\line(1,0){0.52}}
\put(-0.24,0.72){\line(1,0){0.48}}
\put(-0.22,0.66){\line(1,0){0.44}}
\put(-0.2,0.6){\line(1,0){0.4}}
\put(-0.18,0.54){\line(1,0){0.36}}
\put(-0.16,0.48){\line(1,0){0.32}}
\put(-0.14,0.42){\line(1,0){0.28}}
\put(-0.12,0.36){\line(1,0){0.24}}
\put(-0.1,0.3){\line(1,0){0.2}}
\put(-0.08,0.24){\line(1,0){0.16}}
\put(-0.06,0.18){\line(1,0){0.12}}
\put(-0.04,0.12){\line(1,0){0.08}}
\put(-0.02,0.06){\line(1,0){0.04}}
\put(0,1.5){\line(0,1){2}}
\put(1,3.05){\line(0,1){.45}}
\put(.4,3.25){\vector(-1,0){.4}}
\put(.6,3.25){\vector(1,0){.4}}
\put(.425,3.15){$a}
\put(.25,1.55){\(r\)}
\put(.7,1.5){\line(1,0){.5}}
\put(.7,0){\line(1,0){.5}}
\put(.95,1){\vector(0,1){.5}}
\put(.95,.5){\vector(0,-1){.5}}
\put(.9,.6){\(h\)}
\put(-1.5,3){\line(-1,0){.5}}
\put(-1.5,0){\line(-1,0){.5}}
\put(-1.75,1.75){\vector(0,1){1.25}}
\put(-1.75,1.25){\vector(0,-1){1.25}}
\put(-1.9,1.35){$b}
\end{picture}

$PAR
We first need to express the \(r\) in terms of \(h\). We find that
$BR
\(r =\) \{ans_rule()\} (Your answer should be an expression in \(h\).)
$BR
Next we need to express the volume of water in the tank as a function of \(h\).
We find that
$BR
\(V =\) \{ans_rule()\} (Your answer should be an expression in \(h\).)
$BR
Differentiating with respect to time \(t\) we find that at the instant
in question
$BR
\(\frac{dV}{dt}=\) \{ans_rule()\} (Your answer should be a number or numerical expression.)
$BR
and \(\frac{dh}{dt}=\) \{ans_rule()\} (Your answer should be a number or numerical \
expression.)
END_TEXT

HINT("The volume of a cone of height \(h\) and radius \(r\) is \(\frac{1}{3}\pi r^2h\)");

&ANS(function_cmp($ans1,"h"));
&ANS(function_cmp($ans2,"h"));
&ANS(std_num_cmp($ans3));
&ANS(std_num_cmp($ans4));


ENDDOCUMENT();
