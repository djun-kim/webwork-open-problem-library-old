DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl"
);

$showPartialCorrectAnswers = 1;

$pi = 4*atan2(1,1);
$R = random(3,9,1);

TEXT(&beginproblem);
BEGIN_TEXT
\setlength{\unitlength}{0.5in}
\begin{picture}(4.5,4)(-2,-2)
\thicklines
\qbezier(2,0)(2,0.755928946)(1.5,1.322875656)
\qbezier(1.5,1.322875656)(1.283484861,1.568380747)(1,1.732050808)
\qbezier(1,1.732050808)(0.763932023,1.868344718)(0.5,1.936491673)
\qbezier(0.5,1.936491673)(0.254033308,2)(0,2)
\qbezier(-2,0)(-2,0.755928946)(-1.5,1.322875656)
\qbezier(-1.5,1.322875656)(-1.283484861,1.568380747)(-1,1.732050808)
\qbezier(-1,1.732050808)(-0.763932023,1.868344718)(-0.5,1.936491673)
\qbezier(-0.5,1.936491673)(-0.254033308,2)(0,2)
\qbezier(-2,0)(-2,-0.755928946)(-1.5,-1.322875656)
\qbezier(-1.5,-1.322875656)(-1.283484861,-1.568380747)(-1,-1.732050808)
\qbezier(-1,-1.732050808)(-0.763932023,-1.868344718)(-0.5,-1.936491673)
\qbezier(-0.5,-1.936491673)(-0.254033308,-2)(0,-2)
\qbezier(2,0)(2,-0.755928946)(1.5,-1.322875656)
\qbezier(1.5,-1.322875656)(1.283484861,-1.568380747)(1,-1.732050808)
\qbezier(1,-1.732050808)(0.763932023,-1.868344718)(0.5,-1.936491673)
\qbezier(0.5,-1.936491673)(0.254033308,-2)(0,-2)
\put(-1.4,-1.414213562){\line(1,0){2.828427124}}
\put(-1.4,-1.414213562){\line(0,1){2.828427124}}
\put(-1.4,1.414213562){\line(1,0){2.828427124}}
\put(1.414213562,-1.414213562){\line(0,1){2.828427124}}
\thinlines
\put(0,0){\vector(1,0){1.414213562}}
\put(0,0){\vector(1,1){1.414213562}}
\put(1.5,1.414213562){\line(1,0){1}}
\put(1.5,-1.414213562){\line(1,0){1}}
\put(2.3,.2){\vector(0,1){1.214213562}}
\put(2.3,-.2){\vector(0,-1){1.214213562}}
\put(.9,.03){\(r\)}
\put(2.2,-.1){\(h\)}
\put(.5,.8){$R}
\end{picture}

$BR
Find the largest possible total surface area of a cylinder (including top and bottom)
inscribed in a sphere of radius $R (cf. profile view above).

$PAR
We need to maximize the following function \(r\) and \(h\):
$BR
\(S=\) \{ans_rule(25)\}
$BR
Then we solve for \(r\) in terms of \(h\) obtaining:
$BR
\(r=\) \{ans_rule(25)\}
$BR
We thus obtain the following formula for \(S\) in terms of \(h\) alone:
$BR
\(S=\) \{ans_rule(35)\}
$BR
\(h\) varies over the interval \([a,b]\), where
$BR
\(a =\) \{ans_rule(25)\}
$BR
\(b =\) \{ans_rule(25)\}
$BR
\(S\) has two critical points, in increasing order,  at
$BR
\(h_1 =\) \{ans_rule(45)\}
$BR
and at
$BR
\(h_2 =\) \{ans_rule(45)\}
$BR
We conclude that the maximum possible total surface area of such a cylinder is:
$BR
\(S =\) \{ans_rule(35)\}
END_TEXT

$ans1 = "2*$pi*r*h+2*$pi*r**2";
$ans2 = "sqrt(4*$R**2-h**2)/2";
$ans3 = "$pi*sqrt(4*$R**2-h**2)*h+$pi*(4*$R**2-h**2)/4";
$ans4 = 0;
$ans5 = 2*$R;
$ans6 = 2*.5257311121*$R;
$ans7 = 2*.8506508084*$R;
$ans8 = 7.356481492*$R**2;

&ANS(multivar_function_cmp($ans1,['r','h']));
&ANS(function_cmp($ans2,"h"));
&ANS(function_cmp($ans3,"h"));
&ANS(std_num_cmp($ans4));
&ANS(std_num_cmp($ans5));
&ANS(std_num_cmp($ans6));
&ANS(std_num_cmp($ans7));
&ANS(std_num_cmp($ans8));

ENDDOCUMENT();
