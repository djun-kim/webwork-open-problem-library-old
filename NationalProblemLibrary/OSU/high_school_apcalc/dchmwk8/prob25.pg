DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"PGgraders.pl"
);

$c = random(3,5,1);
$b = random($c+1,8,1);
$a = random($b+1,14,1);



TEXT(&beginproblem);
BEGIN_TEXT
What is the maximal length of a $c foot wide dolly which can be
maneuvered around a corner joining a $a foot wide hallway and a
$b foot wide hallway?
$BR

\setlength{\unitlength}{0.5in}
\begin{picture}(5,3)
\thicklines
\put(0,0){\line(0,1){3}}
\put(2,0){\line(0,1){2}}
\put(0,3){\line(1,0){5}}
\put(2,2){\line(1,0){3}}
\put(.39,1.22){\line(2,1){2}}
\put(0,2){\line(2,1){2}}
\put(0,2){\line(1,-2){.39}}
\put(2,3){\line(1,-2){.39}}
\thinlines
\put(1.195,2.11){\vector(-1,2){.195}}
\put(1.195,2.11){\vector(1,-2){.195}}
\put(1,1){\vector(1,0){1}}
\put(1,1){\vector(-1,0){1}}
\put(4,2.5){\vector(0,1){.5}}
\put(4,2.5){\vector(0,-1){.5}}
\put(2.3,2.03){\(\scriptstyle \theta\)}
\put(.9,.7){$a}
\put(4.1,2.4){$b}
\put(1.25,2.05){$c}
\end{picture}

To solve this problem we need to find the critical number for
the following function of \(t = \tan(\theta)\), where the angle
\(\theta\) is as shown in the picture above
$BR
\{ans_rule(40)\}
$BR
The critical number occurs at
$BR
\(t=\) \{ans_rule(30)\}
$BR
Note: you will need to use the Newton-Raphson method to find the critical
number.
$BR
This critical number is a \{ans_rule()\} (Write MAX or MIN.)
$BR
Thus the maximal length of the dolly is:
$BR
\{ans_rule(60)\}
END_TEXT

sub newtr {
  my ($x) = @_;
  $y = $a*$x**3-$b-$c*($x**2-1)*(1+$x**2)**(1/2);
  $yp = -$x*(-3*$a*$x*(1+$x**2)**(1/2)+$c+3*$c*$x**2)/(1+$x**2)**(1/2);
  return $x - $y/$yp;
}
  
$ans1 = "($a+$b/t)*sqrt(1+t**2)-$c*t-$c/t";
$x[0] = 1;
for ($i=0; $i<10; $i++) {
  $x[$i+1] = &newtr($x[$i]);
}
$ans2 = $x[10];
$ans3 = "MIN";
$ans4 = ($a+$b/$ans2)*sqrt(1+$ans2**2)-$c*$ans2-$c/$ans2;

&ANS(function_cmp($ans1,"t"));
&ANS(std_num_cmp($ans2));
&ANS(std_str_cmp($ans3));
&ANS(std_num_cmp($ans4));

ENDDOCUMENT();
