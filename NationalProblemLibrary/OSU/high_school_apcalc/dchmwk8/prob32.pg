DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl"
);

$showPartialCorrectAnswers = 1;

$pi = 4*atan2(1,1);
$a = random(2.5,3.5,.1);
$b = random(2.0,4.5,.1);
$r = random(3,8,1);


TEXT(&beginproblem);
BEGIN_TEXT
A man with a boat is located at point \(P\) on the shore of a circular
lake of radius $r miles. He wants to reach the point \(Q\) on the shore diametrically
opposed to \(P\) as quickly as possible. He plans to paddle his boat at
an angle \(t\) (\(0\le t\le \frac{\pi}{2}\)) to \(PQ\) to some point \(R\)
on the shore, then walk along the shore to his \(Q\). If he can paddle $a
miles per hour and walk at $b miles per hour, what is the shortest possible
time it will take him to reach \(Q\)?
$BR

\setlength{\unitlength}{0.5in}
\begin{picture}(4.6,4)(-2.3,-2)
\thicklines
\qbezier(2,0)(2,0.755928946)(1.5,1.322875656)
\qbezier(1.5,1.322875656)(1.283484861,1.568380747)(1,1.732050808)
\qbezier(1,1.732050808)(0.763932023,1.868344718)(0.5,1.936491673)
\qbezier(0.5,1.936491673)(0.254033308,2)(0,2)
\qbezier(-2,0)(-2,0.755928946)(-1.5,1.322875656)
\qbezier(-1.5,1.322875656)(-1.283484861,1.568380747)(-1,1.732050808)
\qbezier(-1,1.732050808)(-0.763932023,1.868344718)(-0.5,1.936491673)
\qbezier(-0.5,1.936491673)(-0.254033308,2)(0,2)
\qbezier(-2,0)(-2,-0.755928946)(-1.5,-1.322875656)
\qbezier(-1.5,-1.322875656)(-1.283484861,-1.568380747)(-1,-1.732050808)
\qbezier(-1,-1.732050808)(-0.763932023,-1.868344718)(-0.5,-1.936491673)
\qbezier(-0.5,-1.936491673)(-0.254033308,-2)(0,-2)
\qbezier(2,0)(2,-0.755928946)(1.5,-1.322875656)
\qbezier(1.5,-1.322875656)(1.283484861,-1.568380747)(1,-1.732050808)
\qbezier(1,-1.732050808)(0.763932023,-1.868344718)(0.5,-1.936491673)
\qbezier(0.5,-1.936491673)(0.254033308,-2)(0,-2)
\put(-2,0){\line(3,1){3.6}}
\thinlines
\put(-2,0){\line(1,0){4}}
\put(-2.3,-0.1){\(P\)}
\put(2.1,-0.1){\(Q\)}
\put(1.7,1.15){\(R\)}
\put(-1.35,.03){\(t\)}
\put(0,0){\vector(-1,3){.63}}
\put(-.4,1.5){$r}
\end{picture}

$PAR
To solve this problem, we need to minimize the following function of
the angle \(t\):
$BR
\(f(t) = \) \{ans_rule(35)\}
$BR
A critical point for \(f(t)\) is
$BR
\(t = \) \{ans_rule(35)\}
$BR
(Write DNE if there is none.)
$BR
Note: you will need to solve an equation of the form \(\sin(t)= c\), for \(t\)
Use your calculator to do this. Enter \(c\) into your calculator,
then press ``2nd'' (on some calculators
``inv'') and ``sin'', then ``=''. On graphing calculators enter ``2nd'',
``sin'', \(c\), then ``Enter''.  For this problem your calculator should
be in radian mode.

$BR
We conclude that the minimal possible time for the trip is \{ans_rule(25)\}.
$BR
The maximal possible time for the trip is \{ans_rule(25)\}.
END_TEXT

HINT("Draw a perpendicular from the center of the lake to \(PR\) and analyze the resulting right triangles.");

$ans1 = "2*$r*cos(t)/$a + 2*$r*t/$b";
if ($a<= $b) {$ans2 = asin($a/$b);}
else {$ans2 = "DNE";}

$m = 2*$r/$a;
if ($r*$pi/$b<$m) {$m = $r*$pi/$b;}
$ans3 = $m;

if ($a<= $b) {$ans4 = 2*$r*cos($ans2)/$a + 2*$r*$ans2/$b;}
else {$ans4 = $r*$pi/$b;}

&ANS(function_cmp($ans1,"t"));
&ANS(std_num_str_cmp($ans2,["DNE"]));
&ANS(std_num_cmp($ans3));
&ANS(std_num_cmp($ans4));

ENDDOCUMENT();
