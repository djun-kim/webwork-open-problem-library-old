DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl"
);

$showPartialCorrectAnswers = 1;

$pi = 4*atan2(1,1);
$R = random(3,9,1);
$H = random(10,20,1);

TEXT(&beginproblem);

BEGIN_TEXT
\setlength{\unitlength}{0.5in}
\begin{picture}(3.5,3.5)(-.5,-.5)
\thicklines
\put(1,3){\line(-1,-3){1}}
\put(1,3){\line(1,-3){1}}
\qbezier(0,0)(0,-.5)(1,-.5)
\qbezier(1,-.5),(2,-.5)(2,0)
\thinlines
\qbezier(0,0)(0,.5)(1,.5)
\qbezier(1,.5),(2,.5)(2,0)
\put(.4,0){\line(0,1){1.2}}
\put(1.6,0){\line(0,1){1.2}}
\qbezier(.4,1.2)(.4,1)(1,1)
\qbezier(1,1)(1.6,1)(1.6,1.2)
\qbezier(.4,1.2)(.4,1.4)(1,1.4)
\qbezier(1,1.4)(1.6,1.4)(1.6,1.2)
\qbezier(.4,0)(.4,-.2)(1,-.2)
\qbezier(1,-.2)(1.6,-.2)(1.6,0)
\qbezier(.4,0)(.4,.2)(1,.2)
\qbezier(1,.2)(1.6,.2)(1.6,0)
\put(1,0){\vector(3,-1){.89}}
\put(1,1.2){\vector(3,-1){.45}}
\put(1.2,1.2){\(\scriptstyle r\)}
\put(1.7,-0.15){$R}
\put(-.5,1.2){\line(1,0){.8}}
\put(-.5,0){\line(1,0){.4}}
\put(-.3,.8){\vector(0,1){.4}}
\put(-.3,.4){\vector(0,-1){.4}}
\put(-.35,.5){\(h\)}
\put(1.1,3){\line(1,0){1.4}}
\put(2.1,0){\line(1,0){.4}}
\put(2.3,1.7){\vector(0,1){1.3}}
\put(2.3,1.3){\vector(0,-1){1.3}}
\put(2.2,1.4){$H}
\end{picture}

Find the largest possible volume of a cylinder inscribed in a cone of base radius $R
and height $H.


$PAR
We need to maximize the following function \(r\) and \(h\):
$BR
\(V=\) \{ans_rule(25)\}
$BR
Then we solve for \(r\) in terms of \(h\) obtaining:
$BR
\(r=\) \{ans_rule(25)\}
$BR
We thus obtain the following formula for \(V\) in terms of \(h\) alone:
$BR
\(V=\) \{ans_rule(35)\}
$BR
\(h\) varies over the interval \([a,b]\), where
$BR
\(a =\) \{ans_rule(25)\}
$BR
\(b =\) \{ans_rule(25)\}
$BR
\(V\) has two critical points in increasing order:
$BR
\(h_1 =\) \{ans_rule(25)\}
$BR
\(h_2 =\) \{ans_rule(25)\}
$BR
We conclude that the maximum possible volume of such a cylinder is:
$BR
\(V =\) \{ans_rule(35)\}
$PAR
END_TEXT

$ans1 = "$pi*r**2*h";
$ans2 = "$R*($H-h)/$H";
$ans3 = "$pi*$R**2*($H-h)**2*h/$H**2";
$ans4 = 0;
$ans5 = $H;
$ans6 = $H/3;
$ans7 = $H;
$ans8 = $pi*$R**2*($H-$H/3)**2*($H/3)/$H**2;

&ANS(multivar_function_cmp($ans1,['r','h']));
&ANS(function_cmp($ans2,"h"));
&ANS(function_cmp($ans3,"h"));
&ANS(std_num_cmp($ans4));
&ANS(std_num_cmp($ans5));
&ANS(std_num_cmp($ans6));
&ANS(std_num_cmp($ans7));
&ANS(std_num_cmp($ans8));

ENDDOCUMENT();
