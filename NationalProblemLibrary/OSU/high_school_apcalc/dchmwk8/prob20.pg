##Ellis & Gulick section 5.6
##Authored by Zig Fiedorowicz 1/17/2000
DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"PGgraders.pl"
);

#first generate a solution $a/$b of the Diophantine equation y^2 = x^2 - x + 1
$v = random(2,5,1);
$u = random($v+1,12,1);
$a = 2*$v*$u + $u**2;
$b = $u**2 - $v**2;

$c = 1 - $u + $u**2 -2*$v + $u*$v + $v**2;
$ans1 = "($a - 2*x)*($b - 2*x)*x";
$ans2 = 0;
$ans3 = $b/2;
$ans4 = ($u**2+$u*$v-2*$v**2)/6;
$ans5 = -4*($u**2+$u*$v+$v**2);
$ans6 = ($a - 2*$ans4)*($b - 2*$ans4)*$ans4;

TEXT(&beginproblem);
BEGIN_TEXT
A rectangular box with open top is to be formed from a rectangular piece
of cardboard which is $a inches by $b inches by cutting a square of size
\(x\) inches from each corner, and folding up the sides.  What is the largest
possible volume of such a box?
$PAR

\setlength{\unitlength}{0.5in}
\begin{picture}(6,4.2)(0,-.5)
\thicklines
\put(0,.5){\line(0,1){2.5}}
\put(0,.5){\line(1,0){.5}}
\put(.5,0){\line(0,1){.5}}
\put(.5,0){\line(1,0){1.5}}
\put(2,.5){\line(0,-1){.5}}
\put(2,.5){\line(1,0){.5}}
\put(2.5,3){\line(0,-1){2.5}}
\put(2.5,3){\line(-1,0){.5}}
\put(2,3.5){\line(0,-1){.5}}
\put(2,3.5){\line(-1,0){1.5}}
\put(.5,3){\line(0,1){.5}}
\put(.5,3){\line(-1,0){.5}}
\thinlines
\put(0,.4){\line(0,-1){.9}}
\put(2.5,.4){\line(0,-1){.9}}
\put(2.1,0){\line(1,0){.9}}
\put(2.1,3.5){\line(1,0){.9}}
\put(1.0,-.3){\vector(-1,0){1.0}}
\put(1.5,-.3){\vector(1,0){1.0}}
\put(1.05,-.4){$b}
\put(2.8,1.55){\vector(0,-1){1.55}}
\put(2.8,1.95){\vector(0,1){1.55}}
\put(2.6,1.67){$a}
\put(.6,0.2){\(x\)}
\put(.2,0.6){\(x\)}
\put(.2,2.8){\(x\)}
\put(.6,3.2){\(x\)}
\put(1.7,0.2){\(x\)}
\put(2.1,0.6){\(x\)}
\put(2.1,2.8){\(x\)}
\put(1.7,3.2){\(x\)}
\thicklines
\put(5,0){\line(-2,1){1.2}}
\put(5,0){\line(2,1){1.5}}
\put(5,.5){\line(-2,1){1.2}}
\put(5,.5){\line(2,1){1.5}}
\put(3.8,.6){\line(0,1){.5}}
\put(5,0){\line(0,1){.5}}
\put(6.5,.75){\line(0,1){.5}}
\put(3.8,1.1){\line(2,1){1.5}}
\put(6.5,1.25){\line(-2,1){1.2}}
\put(5.3,1.35){\line(0,1){.5}}
\put(5.3,1.35){\line(-2,-1){1}}
\put(5.3,1.35){\line(2,-1){.7}}
\put(5.05,0.25){\(x\)}
\end{picture}

$PAR
To solve this problem we need to maximize the following function
of \(x\):
$BR
\(f(x)=\)\{ans_rule(35)\}
$BR
over the interval from \{ans_rule(5)\} to \{ans_rule(5)\}
$BR
We find that \(f(x)\) has a critical number at \(x=\)\{ans_rule()\}
$BR
To verify that \(f(x)\) has a maximum at this critical number we compute
the second derivative \(f''(x)\) and find that its value at the critical
number is \{ans_rule(35)\}, a negative number.
$BR
Thus the maximum volume of the box is \{ans_rule(35)\}
END_TEXT

&ANS(function_cmp($ans1));
&ANS(std_num_cmp($ans2));
&ANS(std_num_cmp($ans3));
&ANS(std_num_cmp($ans4));
&ANS(std_num_cmp($ans5));
&ANS(std_num_cmp($ans6));

ENDDOCUMENT();
