DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"PGgraders.pl"
);

$a = random(20,35,1);
$b = random(8,15,1);
$pi = atan2(1,1)*4;

TEXT(&beginproblem);
BEGIN_TEXT
\setlength{\unitlength}{0.5in}
\begin{picture}(3.5,3.5)(-.5,-.5)
\thicklines
\put(1,3){\line(-1,-3){1}}
\put(1,3){\line(1,-3){1}}
\qbezier(0,0)(0,-.5)(1,-.5)
\qbezier(1,-.5),(2,-.5)(2,0)
\thinlines
\qbezier(0,0)(0,.5)(1,.5)
\qbezier(1,.5),(2,.5)(2,0)
\put(1,0){\line(-1,2){.6}}
\put(1,0){\line(1,2){.6}}
\qbezier(.4,1.2)(.4,1)(1,1)
\qbezier(1,1)(1.6,1)(1.6,1.2)
\qbezier(.4,1.2)(.4,1.4)(1,1.4)
\qbezier(1,1.4)(1.6,1.4)(1.6,1.2)
\put(1,0){\vector(1,0){1}}
\put(1,1.2){\vector(3,-1){.45}}
\put(1.2,1.2){\(\scriptstyle r\)}
\put(1.4,0.06){$b}
\put(-.5,1.2){\line(1,0){.8}}
\put(-.5,0){\line(1,0){.4}}
\put(-.3,.8){\vector(0,1){.4}}
\put(-.3,.4){\vector(0,-1){.4}}
\put(-.35,.5){\(h\)}
\put(1.1,3){\line(1,0){1.4}}
\put(2.1,0){\line(1,0){.4}}
\put(2.3,1.7){\vector(0,1){1.3}}
\put(2.3,1.3){\vector(0,-1){1.3}}
\put(2.2,1.4){$a}
\end{picture}

$BR
In a cone of height $a and radius of base $b another cone is inscribed
upside down. Find the dimensions of the inscribed cone of maximum volume.

$PAR
We need to maximize the following function of \(r\) and \(h\):
$BR
\(V =\) \{ans_rule(20)\}
$BR
We first express \(h\) in terms of \(r\):
$BR
\(h=\)  \{ans_rule(30)\}
$BR
Thus we can express \(V\) entirely in terms of \(r\) as follows:
$BR
\(V =\) \{ans_rule(40)\}
$BR
There are two critical points, the first (smallest) at
$BR
\(r=\) \{ans_rule(30)\}
$BR
and the second at
\(r=\) \{ans_rule(30)\}
$BR
Thus the cone of maximal volume has dimensions
$BR
\(r=\) \{ans_rule(30)\}
$BR
and \(h=\) \{ans_rule(30)\}
END_TEXT

$ans1 = "$pi*r**2*h/3";
$ans2 = "$a - $a*r/$b";
$ans3 = "$pi*r*($a - $a*r/$b)/3";
$ans3 = 0;
$ans4 = 2*$b/3;
$ans5 = $a - $a*$ans4/$b;

&ANS(multivar_function_cmp($ans1,["r","h"]));
&ANS(function_cmp($ans2,"r"));
&ANS(function_cmp($ans3,"r"));
&ANS(std_num_cmp($ans3));
&ANS(std_num_cmp($ans4));
&ANS(std_num_cmp($ans4));
&ANS(std_num_cmp($ans5));

ENDDOCUMENT();
