##DESCRIPTION
##KEYWORDS('limit','definition', 'left limit')
## tsuda tagged and PAID on 2-20-2004

## DBchapter('Limits and Derivatives')
## DBsection('Calculating Limits using the Limit Laws')
## Date('6/3/2002')
## Author('')
## Institution('')
## TitleText1('Calculus Early Transcendentals')
## EditionText1('4')
## AuthorText1('Stewart')
## Section1('2.3')
## Problem1('2')

##  Find the derivative of an oracle function using 
##  the definition of the derivative.
##ENDDESCRIPTION
&DOCUMENT();

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           'PGgraphmacros.pl',
           "PGnumericalmacros.pl",
           ); 


# define function1 to be evaluated

@x_arr = (-5,-3,0,3,5);
@y_arr = (1,-2,0,3,0,);
@yp_arr = (-1,0,-1,1,-1,);

$herm = new Hermite(~~@x_arr, ~~@y_arr, ~~@yp_arr);
$f1 = $herm -> rf_f;

@x_arr = (-5,-3,0,3,5);
@y_arr = (1,-2,0,-3, -2,);
@yp_arr = (-1,0,-1,1,-1,);

$herm = new Hermite(~~@x_arr, ~~@y_arr, ~~@yp_arr);
$f2 = $herm -> rf_f;

# define function3 to be evaluated
@x_arr = (-5,-3,0,3,5);
@y_arr = (1,-2,0,0,-1,);
@yp_arr = (-1,0,-1,1,-1,);

$herm = new Hermite(~~@x_arr, ~~@y_arr, ~~@yp_arr);
$f3 = $herm -> rf_f;



$llimit = -5; $rlimit = 5;
$del = .05;
$x0=random($llimit+$del,$rlimit-$del , .01);

#  Calculate the cubic spline approximation

my $num_of_intervals = ;  # number of interpolation points
my $delta =  ($rlimit-$llimit)/($num_of_intervals); 
my (@x_values, @y_values);
foreach my $i (0..$num_of_intervals) {
	my $x = $llimit + $delta*$i;
	my $y1 = &$f1($x);
	my $y2 = &$f2($x);
	my $y3 = &$f3($x);
	push(@x_values, $x); push(@y1_values,$y1); push(@y2_values,$y2); push(@y3_values,$y3)
}
$graph = init_graph($llimit, $llimit, $rlimit, $rlimit,axes => [0,0],grid =>[10,10]);
my ($left_rule, $value_rule, $right_rule) = ($f1, $f2,$f3)[NchooseK(3,3)];

my ($left_fun) = new Fun($left_rule, $graph);
$left_fun ->domain($llimit, $x0);
$left_fun ->color('red');


my ($right_fun) = new Fun($right_rule, $graph);
$right_fun ->domain($rlimit, $x0);
$right_fun ->color('red');

$graph->stamps(open_circle($x0, $left_fun->rule->($x0), 'red') );
$graph->stamps(open_circle($x0, $right_fun->rule->($x0), 'red') );
# the closed circle needs to printed last.
$graph->stamps( closed_circle($x0 , &$value_rule($x0) , 'red' )  ) ;
$left_limit  = $left_fun->rule->($x0);
$value       = &$value_rule($x0)  ; 
$right_limit = $right_fun->rule->($x0);


TEXT(beginproblem());


BEGIN_TEXT

\{ image(insertGraph($graph) ) \}

$PAR
Determine the limits for the function \( f\) at  \($x0\).
$PAR
\( \displaystyle \lim_{x\to $x0^{-} } f(x) \) = \{ans_rule(10)\}$BR
\( f($x0) \)   =\{ ans_rule(10) \}$BR
\( \displaystyle \lim_{x\to $x0^{+}  } f(x) \) = \{ ans_rule(10) \}$BR
$PAR
Is this function continuous at \($x0\)?: (Y or N) \{ ans_rule(6) \}$BR
Can this function be made continuous by changing its value at \($x0 \)?: (Y or N) \{ ans_rule(6) \}
$PAR

END_TEXT
$answer_tol = ($rlimit-$llimit)/10;
$continuousQ = 'N';
$continuousQ = 'Y' if (abs($left_limit - $value) < $answer_tol and abs($value - $right_limit) < $answer_tol);
$madeContinuousQ = 'N';
$madeContinuousQ = 'Y' if (abs($left_limit - $right_limit) < $answer_tol);




ANS( num_cmp([ $left_limit,$value,$right_limit ], tol => $answer_tol ) ,std_str_cmp_list( $continuousQ, $madeContinuousQ ) );  #We are allowing 1 percent error for the answer.

			
&ENDDOCUMENT;

