## DESCRIPTION
## Systems of ODEs: introduction to systems of ODEs
## ENDDESCRIPTION

## KEYWORDS('differential equations','systems of ODEs')

## DBsubject('Differential Equations')
## DBchapter('Linear Systems of Differential Equations')
## DBsection('Linear Systems')
## Date('01/30/2012')
## Author('Paul Pearson')
## Institution('Fort Lewis College')
## TitleText1('Elementary Differential Equations')
## EditionText1('2006')
## AuthorText1('Kohler and Johnson')
## Section1('4.2')
## Problem1('15')


##############################
#  Initialization

DOCUMENT(); 

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"parserImplicitEquation.pl",
"AnswerFormatHelp.pl",
"unionLists.pl",
"weightedGrader.pl",
"problemRandomize.pl",
);

ProblemRandomize(when=>"Always");

TEXT(beginproblem());

install_weighted_grader();


#############################
#  Setup

Context("ImplicitEquation");
Context()->variables->{namePattern} = qr/[a-z][a-z0-9_]*'*/i;
Context()->variables->are(
"y1" => "Real",
"y1'" => "Real",
"y1''" => "Real",
"y2" => "Real",
"y2'" => "Real",
"y2''" => "Real",
"t"=>"Real"
);
Context()->variables->set(
"y1"   => {limits=>[-100,100]},
"y1'"  => {limits=>[-100,100]},
"y1''" => {limits=>[-100,100]},
"y2"   => {limits=>[-1,1]},
"y2'"  => {limits=>[-1,1]},
"y2''" => {limits=>[-1,1]},
"t"    => {limits=>[-100,100]},
);


$P11 = 0;
$P12 = 1;
$P21 = random(-1,1,2) * random(2,6,1);
do { $P22 = random(-1,1,2) * random(2,6,1); } until ($P22 != $P21);

$a = random(2,5,1);
do { $b = random(2,5,1); } until ($b != $a);

$g1 = Formula("0");
$g2 = Formula("$a cos($b t)");

$tinit  = non_zero_random(-5,5,1);
$y1init = non_zero_random(-5,5,1);
$y2init = non_zero_random(-5,5,1);


$diffeq = ImplicitEquation("y1'' - $P22 y1' - $P21 y1 = $g2");

$init = ImplicitEquation("y1($tinit) = $y1init");
$initder = ImplicitEquation("y1' ($tinit) = $y2init");



######################
#  Main text

Context()->texStrings;
BEGIN_TEXT
Consider the initial value problem
$PAR
\[
\left\lbrack
\begin{array}{c}
y_1^{\,\prime} \\
y_2^{\,\prime}
\end{array}
\right\rbrack 
=
\left\lbrack 
\begin{array}{rr}
$P11 & $P12 \\
$P21 & $P22 
\end{array}
\right\rbrack
\left\lbrack
\begin{array}{c}
y_1 \\
y_2
\end{array}
\right\rbrack 
+
\left\lbrack
\begin{array}{c}
$g1 \\
$g2
\end{array}
\right\rbrack, 
\]
$PAR
\[ 
\boldsymbol{\vec{y}}($tinit) = 
\left\lbrack
\begin{array}{r}
$y1init \\
$y2init
\end{array}
\right\rbrack.
\]
$BR
This initial value problem was obtained from 
an initial value problem from a higher order
scalar differential equation.  What is the 
corresponding scalar initial value problem?

\{ BeginList("OL",type=>'a') \}

$ITEM
Differential equation: \{ ans_rule(50) \}
\{ AnswerFormatHelp("equations") \}
$BR
$BR
(Give your answer in terms of
\( y_1, y_1^{\,\prime}, y_1^{\,\prime\prime}, y_2, y_2^{\,\prime}, y_2^{\,\prime\prime}, t \).
Enter 
\( y_1 \) as ${BTT}y1${ETT},
\( y_1^{\,\prime} \) as ${BTT}y1'${ETT},
\( y_1^{\,\prime\prime} \) as ${BTT}y1''${ETT},
and similarly for \( y_2 \).)  

$ITEMSEP
$ITEM
Initial conditions: \{ ans_rule(15) \}
and
\{ ans_rule(15) \}
\{ AnswerFormatHelp("equations") \}
$BR
$BR
(Give your first answer in the form \( y_1(t_0) = y_0 \)
or \( y_2(t_0) = y_0 \), whichever is appropriate.
$BR
Give your second answer in the form
\( y_1'(t_0) = y_0' \)
or \( y_2'(t_0) = y_0' \), whichever is appropriate.
) 

\{ EndList("OL") \}
END_TEXT
Context()->normalStrings;


######################
#  Answer evaluation

$showPartialCorrectAnswers = 1;

WEIGHTED_ANS( $diffeq->cmp(), 80 );

WEIGHTED_ANS( $init->cmp(), 10 );

WEIGHTED_ANS( $initder->cmp(), 10 );


COMMENT("MathObject version");

ENDDOCUMENT();
