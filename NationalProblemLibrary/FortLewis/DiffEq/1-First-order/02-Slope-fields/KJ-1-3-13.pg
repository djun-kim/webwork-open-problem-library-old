## DESCRIPTION
## First order ODEs: slope fields and the uniqueness theorem
## ENDDESCRIPTION

## KEYWORDS('differential equations','first order','slope fields','direction fields')

## DBsubject('Differential Equations')
## DBchapter('First Order Differential Equations')
## DBsection('Existence and Uniqueness')
## Date('01/01/2012')
## Author('Paul Pearson')
## Institution('Fort Lewis College')
## TitleText1('Elementary Differential Equations')
## EditionText1('2')
## AuthorText1('Kohler and Johnson')
## Section1('1.3')
## Problem1('13')


##############################
#  Initialization

DOCUMENT(); 

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"AnswerFormatHelp.pl",
"unionLists.pl",
);

TEXT(beginproblem());


#############################
#  Setup

Context("Numeric")->variables->are(y=>"Real");

$d = random(2,5,1);

$answer = Compute("sin($d pi y)");


#############################
#  Main text

Context()->texStrings;
BEGIN_TEXT
Find an autonomous differential equation with
equilibrium solutions at \( y = n/$d \) for 
\( n = 0, \pm 1, \pm 2, \ldots \) 
$BR
$BR
\( \displaystyle \frac{dy}{dt} = \)
\{ ans_rule(20) \}
\{ AnswerFormatHelp("formulas") \}
END_TEXT
Context()->normalStrings;


############################
#  Answers

$showPartialCorrectAnswers = 1;

ANS( $answer->cmp( checker=>
sub {

  my ( $correct, $student, $ansHash ) = @_;
  if ($student->D('t') != Formula("0")) { return 0; }
  @yp_stu = ();
  foreach my $y (0..40) {
    $yp_stu[$y] = sgn($student->eval(y=>($y-10)/(4*$d)));
    $yp_cor[$y] = sgn($correct->eval(y=>($y-10)/(4*$d)));
    if ($yp_stu[$y] != $yp_cor[$y]) { return 0; }
  }
  return 1;
} 
));


COMMENT("MathObject version.");

ENDDOCUMENT();
