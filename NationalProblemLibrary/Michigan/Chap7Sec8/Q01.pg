# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
# ENDDESCRIPTION

##KEYWORDS('Calculus', 'Improper Integral')
##Tagged by jjh2b

##DBsubject('Calculus')
##DBchapter('Techniques of Integration')
##DBsection('Improper Integrals')
##Date('')
##Author('LaRose')
##Institution('Michigan')
##TitleText1('Calculus')
##EditionText1('4')
##AuthorText1('Hughes-Hallett')
##Section1('7.8')
##Problem1('')

DOCUMENT();
loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"hhAdditionalMacros.pl",
);

TEXT(&beginproblem);
$showPartialCorrectAnswers = 1;

$a = random(1,9,1);
$b = $a + 1;
$c = ( $a == 1 ) ? 1 : ($a-1);
$d = random(2,9,1);
$r = random(3,4,1);
$rm1 = $r-1;
$rm2 = $r-2; $rm2exp = ( $rm2 == 1 ) ? '' : "^{$rm2}";

# functions we can use in the integrand of the integral; 
#   $func[i] = [ integrand, comparison function, convergence,
#                comparison function (tex) ]
@func = ( [ "{x$rm2exp\over x^{$r} + $a}", '1/x^2', 'converges',
        '{1\over x^2}' ],
      [ "{x^{$rm1} + 1\over x^{$r} + $b x + $c}", '1/x', 'diverges',
        '{1\over x}' ],
      [ "{x\over x + $a}", '1', 'diverges', '1' ],
      [ "{x\over x^2 + $b x + $c}", '1/x', 'diverges', '{1\over x}' ],
      [ "{$b x + $c\over x^{$r} + $d x^{$rm1} + $c}", "1/x^{$rm1}",
        'converges', '{1\over x^{$rm1}}' ],
      [ "{x$rm2exp + $c\over x^{$r} + $b x$rm2exp + $d}", 
        '1/x^2', 'converges', '{1\over x^2}' ],
      [ "{1\over e^{$rm1 x} + $c}", "1/e^($rm1*x)", 'converges',
        "e^{-$rm1 x}" ],
      [ "{e^{$rm1 x}\over e^{$r x} + $c}", "1/e^(x)", 'converges',
        'e^{-x}' ],
      [ "{e^{$r x}\over e^{$r x} + $b e^{$rm1 x}}", '1', 'diverges',
        '1' ], );

# pick four of these to display
($shuff, $zind) = shufflemap( scalar(@func) );
@which = ( $shuff->{0}, $shuff->{1}, $shuff->{2}, $shuff->{3} );

BEGIN_TEXT

For each of the following integrals, predict whether the improper
integral converges.  In this case we're looking for a casual
comparison that we would use to guide our search for a comparison
integral that would prove convergence or divergence.  For example, for 
$BR
${BCENTER}
\{ begintable(5) \}
\{ row( "\(\int_1^{\infty}{x\over x^2+1}\,dx\) :", 
    "for large \(x\) the integrand looks like", 
    "1/x", "so we predict the integral", "diverges" ) \}
\{ endtable() \}
$ECENTER
(For convergence, enter ${BBOLD}converges$EBOLD or
${BBOLD}diverges$EBOLD.) 

$PAR
${BCENTER}
\{ begintable(5) \}
\{ row( "\(\int_1^{\infty} $func[$which[0]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    ans_rule(15), 
    "so we predict the integral", 
    ans_rule(15) ) \}
\{ row( "\(\int_1^{\infty} $func[$which[1]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    ans_rule(15), 
    "so we predict the integral", 
    ans_rule(15) ) \}
\{ row( "\(\int_1^{\infty} $func[$which[2]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    ans_rule(15), 
    "so we predict the integral", 
    ans_rule(15) ) \}
\{ row( "\(\int_1^{\infty} $func[$which[3]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    ans_rule(15), 
    "so we predict the integral", 
    ans_rule(15) ) \}
\{ endtable() \}
$ECENTER

END_TEXT

ANS( fun_cmp( $func[$which[0]]->[1] ) );
ANS( str_cmp( $func[$which[0]]->[2] ) );
ANS( fun_cmp( $func[$which[1]]->[1] ) );
ANS( str_cmp( $func[$which[1]]->[2] ) );
ANS( fun_cmp( $func[$which[2]]->[1] ) );
ANS( str_cmp( $func[$which[2]]->[2] ) );
ANS( fun_cmp( $func[$which[3]]->[1] ) );
ANS( str_cmp( $func[$which[3]]->[2] ) );

SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR

$BCENTER
\{ begintable(5) \}
\{ row( "\(\int_1^{\infty} $func[$which[0]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    "\($func[$which[0]]->[3]\)",
    "so we predict the integral", 
    $func[$which[0]]->[2] ) \}
\{ row( "\(\int_1^{\infty} $func[$which[1]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    "\($func[$which[1]]->[3]\)",
    "so we predict the integral", 
    $func[$which[1]]->[2] ) \}
\{ row( "\(\int_1^{\infty} $func[$which[2]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    "\($func[$which[2]]->[3]\)",
    "so we predict the integral", 
    $func[$which[2]]->[2] ) \}
\{ row( "\(\int_1^{\infty} $func[$which[3]]->[0] \,dx\) :", 
    "for large \(x\) the integrand looks like", 
    "\($func[$which[3]]->[3]\)",
    "so we predict the integral", 
    $func[$which[3]]->[2] ) \}
\{ endtable() \}
$ECENTER

END_SOLUTION

ENDDOCUMENT();
