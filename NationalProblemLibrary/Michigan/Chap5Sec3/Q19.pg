# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
# ENDDESCRIPTION

## KEYWORDS('calculus')
## Tagged by cmd6a 09/05/07

## DBsubject('Calculus')
## DBchapter('Integrals')
## DBsection('The Definite Integral')
## Date('')
## Author('Gavin LaRose')
## Institution('University of Michigan')
## TitleText1('Calculus')
## EditionText1('4')
## AuthorText1('Hughes-Hallett')
## Section1('5.3')
## Problem1('')

DOCUMENT();
loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"PGgraphmacros.pl", 
);
 
TEXT(&beginproblem);
$showPartialCorrectAnswers = 1;

# we graph the number of workers as the function 
#   f(x) = a + b sin(pi t/8) for 0 < x < 12,
#          a - b             for 12 < x < 20,
#          a + b sin(pi (t-24)/8) for 20 < x < 36
#          a - b             for 36 < x < 44
#          a + b sin(pi (t-48)/8) for 44 < x < 48
# and then assign random values to the cost per worker

$a = random(30,50,5);
$b = random(5,25,5);

$pay = random(10,20,1);
$overtime = 1.5*$pay;

$ymax = $a+$b;
$ymax += ( $ymax/10 == int($ymax/10) ) ? 10 : 5;
$gr = init_graph(0,0,48,$ymax,'axes'=>[0,0],'grid'=>[6,$ymax/10]);
$gr->lb('reset');
$gr->lb(new Label(8,2,'8','black','center','right'));
$gr->lb(new Label(48,2,'48','black','center','right'));
$gr->lb(new Label(0,10,'10','black','top','left'));
$gr->lb(new Label(0,$ymax,"$ymax",'black','top','left'));
$f1 = "$a + $b*sin(pi*x/8) for x in <0,12> using color:blue and weight:2";
$f2 = "$a - $b for x in <12,20> using color:blue and weight:2";
$f3 = "$a + $b*sin(pi*(x-24)/8) for x in <20,36> using color:blue and weight:2";
$f4 = "$a - $b for x in <36,44> using color:blue and weight:2";
$f5 = "$a + $b*sin(pi*(x-48)/8) for x in <44,48> using color:blue and weight:2";
add_functions($gr,$f1,$f2,$f3,$f4,$f5);

# then the area under this curve for times between 9am and 5pm is 
$pi = 3.141592654;
$day = 16*($a + 2*$b/$pi);
# and the overtime area is 
$night = 16*(2*$a - (1 + 2/$pi)*$b);

BEGIN_TEXT

A two-day environmental clean up started at 9AM on the first day.  The
number of workers fluctuated as shown in the following figure.
$PAR
$BCENTER
\{ image(insertGraph($gr),'tex_size'=>500) \}
$BR
${BITALIC}(Click on the graph for a larger version.)$EITALIC
$ECENTER
$PAR
Suppose that the workers were paid $pay dollars per hour for work during
the time period 9 am to 5 pm and were paid $overtime dollars per hour for
work during the rest of the day.  What would the total personnel costs of
the clean up have been under these conditions?
$BR
total cost = \{ ans_rule(35) \} dollars

END_TEXT

ANS( num_cmp( "$day*$pay + $night*$overtime", 'tol'=>80*($pay) ) );

# each box is 8 hours by 10 people = 80 person-hours large
$dayboxes = round($day/8)/10;
$nightboxes = round($night/8)/10;
$daywh = $dayboxes*80;
$nightwh = $nightboxes*80;
$regular = $daywh*$pay;
$extra = $nightwh*$overtime;
$totalcost = $regular + $extra;

SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR
 
The time period 9AM to 5PM is represented by the time \(t=0\)
to \(t=8\) and \(t=24\) to \(t=32\).  The area under the curve, or total
number of worker-hours for these times, is about $dayboxes boxes or
\($dayboxes(80) = $daywh\) worker-hours.  The total cost for 9AM to 5PM is
therefore \(($daywh)($pay)=$regular\) dollars.   The area under the rest of
the curve is about $nightboxes boxes, or \($nightboxes(80)=$nightwh\)
worker-hours.  The total cost for this time period is
\(($nightwh)($overtime) = $extra\) dollars.  The total cost is about
\($regular + $extra = $totalcost\) dollars.

END_SOLUTION

ENDDOCUMENT();
