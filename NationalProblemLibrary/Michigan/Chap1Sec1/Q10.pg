# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Aaron Wooton, <wootton@up.edu>
# ENDDESCRIPTION

DOCUMENT();

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"PGgraphmacros.pl"
);


install_problem_grader(~~&std_problem_grader);

$showPartialCorrectAnswers = 0;

$graph = init_graph(-8,-8,8,8,'axes'=>[0,0],'grid'=>[8,8]);
$graph2 = init_graph(-8,-8,8,8,'axes'=>[0,0],'grid'=>[8,8]);
$graph3 = init_graph(-8,-8,8,8,'axes'=>[0,0],'grid'=>[8,8]);
$graph4 = init_graph(-8,-8,8,8,'axes'=>[0,0],'grid'=>[8,8]);
$graph5 = init_graph(-8,-8,8,8,'axes'=>[0,0],'grid'=>[8,8]);
$graph6 = init_graph(-8,-8,8,8,'axes'=>[0,0],'grid'=>[8,8]);


@colors = ("blue", "red", "green"); #orange, yellow,
@scrambled_colors = @colors;
@labels = ('A', 'B', 'C');
@scrambled_labels = @labels;
  
$b1=non_zero_random(1, 5, .1);
$a2=random(1, 3, .1);
$b2=random(1, 3, .1);
$a3=random(1, 3, .1);
$a4=random(-3, -1, .1);
$b4=random(1, 3, .1);
$a5=random(1, 3, .1);
$b5=random(-3, -1, .1);
$a6=random(-3, -1, .1);
$b6=random(-3, -1, .1);

$f = FEQ(
       "$b1 for x in <-8,8> using color:$scrambled_colors[0] and weight:2"
);

$f2 = FEQ(
       "$b2 +$a2 *x for x in <-8,8> using color:$scrambled_colors[0] and weight:2"
);

$f3 = FEQ(
       "$a3 *x for x in <-8,8> using color:$scrambled_colors[0] and weight:2"
);

$f4 = FEQ(
       "$b4 +$a4 *x for x in <-8,8> using color:$scrambled_colors[0] and weight:2"
);

$f5 = FEQ(
       "$b5 +$a5 *x for x in <-8,8> using color:$scrambled_colors[0] and weight:2"
);

$f6 = FEQ(
       "$b6 +$a6 *x for x in <-8,8> using color:$scrambled_colors[0] and weight:2"
);


($fRef) = plot_functions( $graph,
                                       $f
                                       );
($f2Ref) = plot_functions( $graph2,
                                       $f2
                                       );
($f3Ref) = plot_functions( $graph3,
                                       $f3
                                       );
($f4Ref) = plot_functions( $graph4,
                                       $f4
                                       );
($f5Ref) = plot_functions( $graph5,
                                       $f5
                                       );
($f6Ref) = plot_functions( $graph6,
                                       $f6
                                       );


$graph->gifName($graph->gifName()."-$newProblemSeed");
$graph2->gifName($graph2->gifName()."-$newProblemSeed");
$graph3->gifName($graph3->gifName()."-$newProblemSeed");
$graph4->gifName($graph4->gifName()."-$newProblemSeed");
$graph5->gifName($graph5->gifName()."-$newProblemSeed");
$graph6->gifName($graph6->gifName()."-$newProblemSeed");

$questStr1 = EV2("");
$ansStr1 = EV2("y=$b1");
$questStr2 = EV2("");
$ansStr2 = EV2("y=$b2 +$a2 x");
$questStr3 = EV2("");
$ansStr3 = EV2("y=$a3 x");
$questStr4 = EV2("");
$ansStr4 = EV2("y=$b4 $a4 x");
$questStr5 = EV2("");
$ansStr5 = EV2("y=$b5 +$a5 x");
$questStr6 = EV2("");
$ansStr6 = EV2("y=$b6 $a6 x");

@questions =( $questStr1,$questStr2,$questStr3,$questStr4,$questStr5,$questStr6);
@answers =( $ansStr1,$ansStr2,$ansStr3,$ansStr4,$ansStr5,$ansStr6);
@shuffle = &shuffle(scalar(@questions));

TEXT(&beginproblem);

BEGIN_TEXT
1 \{ image(insertGraph($graph)) \}
2 \{ image(insertGraph($graph2)) \}
3 \{ image(insertGraph($graph3)) \} $PAR
4 \{ image(insertGraph($graph4)) \}
5 \{ image(insertGraph($graph5)) \}
6 \{ image(insertGraph($graph6)) \}

$BR
Match the following functions with their graphs.
$BR

END_TEXT

TEXT(
&match_questions_list(@questions),
&OL(@answers[@shuffle])
);

&ANS( str_cmp([ @ALPHABET[&invert(@shuffle)] ] ) );

SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR
1. is $ansStr1 because the slope is 0 and the vertical intercept is positive.
$BR
2. is $ansStr2 because the slope is positive and the vertical intercept is positive.
$BR
3. is $ansStr3 because the slope is positive and the vertical intercept is 0.
$BR
4. is $ansStr4 because the slope is negative and the vertical intercept is positive.
$BR
5. is $ansStr5 because the slope is positive and the vertical intercept is negative.
$BR
6. is $ansStr6 because the slope is negative and the vertical intercept is negative.

END_SOLUTION

ENDDOCUMENT();
