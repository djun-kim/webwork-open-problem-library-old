# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
# ENDDESCRIPTION

## KEYWORDS('calculus')
## Tagged by cmd6a 09/05/07

## DBsubject('Calculus')
## DBchapter('Integrals')
## DBsection('The Fundamental Theorem of Calculus')
## Date('')
## Author('Gavin LaRose')
## Institution('University of Michigan')
## TitleText1('Calculus')
## EditionText1('4')
## AuthorText1('Hughes-Hallett')
## Section1('6.4')
## Problem1('')

DOCUMENT();
loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
);
 
TEXT(&beginproblem);
$showPartialCorrectAnswers = 1;

$a = random(1,8,1);
$whichf = random(1,4,1);
$whichg = random(1,5,1);
($f_tex, $f_ans) = pickf($whichf);
($g_tex, $g_ans) = pickf($whichg);

$gt_ans = $g_ans;  $gt_tex = $g_tex;
$gt_ans =~ s/x/t/; $gt_tex =~ s/x/t/;

$func_t_tex = ( $whichg == 5 ) ? "$f_tex($gt_tex)" : "$f_tex($gt_tex(t))";
$func_x_tex = ( $whichg == 5 ) ? "$f_tex($g_tex)" : "$f_tex($g_tex(x))";
$funcans = ( $whichg == 5 ) ? "$f_ans($g_ans)" : "$f_ans($g_ans(x))";

sub pickf { 
    my $which = shift();
    if ( $which == 1 ) {
	return( '\sin', 'sin' );
    } elsif ( $which == 2 ) {
	return( '\cos', 'cos' );
    } elsif ( $which == 3 ) { 
	return( '\tan', 'tan' );
    } elsif ( $which == 4 ) {
	return( '\ln', 'ln' );
    } elsif ( $which == 5 ) {
	$n = random(2,5,1);
	return( "x^{$n}", "x^($n)" );
    }
}

BEGIN_TEXT

Find the derivative:
\( \frac{d}{dx}\int^a_x $func_t_tex\,dt = \) \{ ans_rule(35) \}

END_TEXT

ANS( fun_cmp( "-1*$funcans", 'var'=>['x','t'] ) );

SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR

\(\frac{d}{dx} \int_x^$a {$func_t_tex \,dt} =
\frac{d}{dx}\left(-\int_1^x{$func_t_tex \,dt}\right) = 
- $func_x_tex.\)

END_SOLUTION

ENDDOCUMENT();
