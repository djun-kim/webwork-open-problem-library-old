# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
# ENDDESCRIPTION

## KEYWORDS('calculus', 'integral', 'series', 'geometric series')
## Tagged by glr 02/08/09

## DBsubject('Calculus')
## DBchapter('Infinite Sequences and Series')
## DBsection('Geometric Series')
## Date('')
## Author('Gavin LaRose')
## Institution('University of Michigan')
## TitleText1('Calculus')
## EditionText1('4')
## AuthorText1('Hughes-Hallett')
## Section1('9.2')
## Problem1('25')

## Textbook tags
## HHChapter('Sequences and Series')
## HHSection('Geometric Series')

DOCUMENT();
loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
);

Context("Numeric");

TEXT(beginproblem());
$showPartialCorrectAnswers = 1;

$dose = random(35,65,5);
$num = list_random(12, 24);
$freq = ( $num == 24 ) ? 'daily' : 'twice per day';

$half = random(5.3, 7.3, 0.1);

Context()->texStrings;
BEGIN_TEXT

Consider a drug that is taken in $dose mg doses $freq.  Suppose that
the first dose is taken when \(t = 0\) and that \(t\) is measured in
hours.

$PAR
${BBOLD}A.$EBOLD
If the half-life of the drug is $half hours, what fraction of the drug
remains in the patient after $num hours?
$BR
fraction = \{ ans_rule(15) \}

$PAR
${BBOLD}B.$EBOLD
Write a general expression for the amount of the drug in the patient
immediately after s/he takes an \(n\)th dose of the drug.
$BR
\( A_n = \) \{ ans_rule(35) \}

$PAR
${BBOLD}C.$EBOLD
Write a general expression for the amount of the drug in the patient
immediately before s/he takes an \(n\)th dose of the drug (for this we
only consider \(n>1\)).
$BR
\( P_n = \) \{ ans_rule(35) \}

$PAR
${BBOLD}D.$EBOLD
What is the long-term minimum amount of drug in the patient?
$BR
Long-term minimum = \{ ans_rule(35) \} mg

END_TEXT
Context()->normalStrings;

ANS( num_cmp( "(1/2)^($num/$half)" ) );
ANS( fun_cmp( "$dose*(1 - ((1/2)^($num/$half))^(n))/(1 - (1/2)^($num/$half))",
	      'var'=>['n'] ) );
ANS( fun_cmp( "$dose*((1/2)^($num/$half))(1 - ((1/2)^($num/$half))^(n-1)) / " .
              "(1 - (1/2)^($num/$half))",
	      'var'=>['n'] ) );
ANS( num_cmp( "$dose*((1/2)^($num/$half))/(1 - (1/2)^($num/$half))" ) );

$frac = round(1000*$dose*((1/2)**($num/$half)))/1000;
$findose = round(1000*$dose*((1/2)**($num/$half))/(1 - (1/2)**($num/$half)))/1000;

Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR

${BBOLD}A.$EBOLD
Note that, \(t\) hours after taking a dose of $dose mg, the amount of the
drug in the patient's system is \($dose ({1\over2})^{t/$half}\) mg.  Thus
after $num hours, the amount is 
\($dose ({1\over2})^{$num/$half} \approx $frac \) mg.

$PAR
${BBOLD}B.$EBOLD
The amount of the drug immediately after the first dose is $dose mg;
after the second, \( $dose + $dose ({1\over2})^{$num/$half} \) mg; after the
third, 
\( $dose + $dose ({1\over2})^{$num/$half} + $dose ({1\over2})^{2($num)/$half} \)
mg, etc.  Thus after the \(n\)th dose, the amount is
\[ 
  $dose + $dose ({1\over2})^{$num/$half} + $dose ({1\over2})^{2($num)/$half} + 
    \cdots + $dose ({1\over2})^{$num(n-1)/$half} = 
  {$dose (1 - ({1\over2})^{$num n/$half})\over 1 - ({1\over2})^{$num/$half}}.
\]

$PAR
${BBOLD}C.$EBOLD
The amount of the drug immediately before the second dose is 
\( $dose ({1\over2})^{$num/$half} \) mg; before the third, 
\( $dose ({1\over2})^{$num/$half} + $dose ({1\over2})^{2($num)/$half} \) mg, 
etc.  Thus before the \(n\)th dose (\(n > 1\)), the amount is
\[ 
  $dose ({1\over2})^{$num/$half} + $dose ({1\over2})^{2($num)/$half} + \cdots
    + $dose ({1\over2})^{$num(n-1)/$half} = 
  {$dose ({1\over2})^{$num/$half} (1 - ({1\over2})^{$num(n-1)/$half})\over 
    1 - ({1\over2})^{$num/$half}}.
\]

$PAR
${BBOLD}D.$EBOLD
As \(n\to\infty\), the result in ${BBOLD}C$EBOLD goes to 
\( {$dose ({1\over2})^{$num/$half} \over 1 - ({1\over2})^{$num/$half}}
  \approx $findose\) mg.

END_SOLUTION
Context()->normalStrings;

ENDDOCUMENT();
