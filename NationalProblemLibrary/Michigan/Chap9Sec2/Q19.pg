# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
# ENDDESCRIPTION

##KEYWORDS('Calculus', 'Geometric Series')
##Tagged by jjh2b

##DBsubject('Calculus')
##DBchapter('Infinite Sequences and Series')
##DBsection('Geometric Series')
##Date('')
##Author('LaRose')
##Institution('Michigan')
##TitleText1('Calculus')
##EditionText1('4')
##AuthorText1('Hughes-Hallett')
##Section1('9.2')
##Problem1('')

DOCUMENT();
loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
"hhAdditionalMacros.pl",
);

TEXT(&beginproblem);
$showPartialCorrectAnswers = 1;

$a = random(2,5,1);
$r = random(2,4,1);
$rs2 = $r*$r;  $rs3 = $rs2*$r;  $rs4 = $rs3*$r;  $rs5 = $rs4*$r;
$ra = $r*$a;
$ns = random(3,6,1);
$nf = 10 + random(1,10,1);
$nfs1 = $nf - $ns + 1;
$sgn = ( $nf/2 == int($nf/2) ) ? '+' : '-';

$q = random(2,4,1);
$r1 = $r + 1;
$q1 = $q - 1;

# pick one infinite and one finite series
$whichinf = list_random(0,1);

# the series
@ser = ();
@soln = ();

$nsf1 = $nf - $ns + 1;
$nf1 = $nf + 1;
$ns1 = $ns - 1;

if ( $whichinf ) {
    push( @ser, "-$ra + $a - {$a\over $r} + {$a\over $rs2} - " .
      "{$a\over $rs3} + {$a\over $rs4} - \cdots" );
    push( @soln, [ "-$ra/(1 + 1/$r)", "{-$ra\over 1 + {1\over $r}}",
           reduced_frac(-1*$r*$ra, $r+1) ] );

    push( @ser, "\sum\limits_{n=$ns}^{$nf} \left({1\over $q}\right)^n" );
    push( @soln, [ "(1/$q)^($ns)*(1 - (1/$q)^($nf-$ns+1))/(1 - (1/$q))", 
           "{1\over $q^{$ns}}\cdot " .
            "{1 - ({1\over $q})^{$nfs1}\over 1 - {1\over $q}}",
           "{1\over $q^{$ns1}}\cdot " . 
            "{(1 - ({1\over $q})^{$nfs1})\over $q1}" ] );

} else {
    $rra = $r*$ra;
    push( @ser, "-$ra + $a - {$a\over $r} + {$a\over $r^2} - " .
      "{$a\over $r^3} + \cdots $sgn {$a\over $r^{$nf}}" );
    push( @soln, [ "-$ra*(1 - (-1/$r)^($nf+2))/(1 + 1/$r)", 
           "{-$ra(1 - (-{1\over $r})^{$nf1}\over 1 + {1\over $r}}",
           "{-$rra(1 - (-{1\over $r})^{$nf1})\over $r1}" ] );

    push( @ser, "\sum\limits_{n=$ns}^{\infty} \left({1\over $q}\right)^n" );
    push( @soln, [ "(1/$q)^{$ns}/(1 - (1/$q))", 
           "{({1\over $q})^{$ns}\over 1 - {1\over $q}}",
           "(" . reduced_frac($q, $q-1) . ")\cdot({1\over $q})^{$ns}" ] );

}

BEGIN_TEXT

Find the sum of each of the geometric series given below.  For the
value of the sum, enter an expression that gives the exact value,
rather than entering an approximation.

$PAR
${BBOLD}A.$EBOLD
\( $ser[0] = \) \{ ans_rule(35) \}

$PAR
${BBOLD}B.$EBOLD
\( $ser[1] = \) \{ ans_rule(35) \}

END_TEXT

ANS( num_cmp( $soln[0]->[0], 'relTol'=>0.0001 ) );
ANS( num_cmp( $soln[1]->[0], 'relTol'=>0.0001 ) );

SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR

${BBOLD}A.$EBOLD
\( $ser[0] = $soln[0]->[1] = $soln[0]->[2] \).

$PAR
${BBOLD}B.$EBOLD
\( $ser[1] = $soln[1]->[1] = $soln[1]->[2] \).

END_SOLUTION

ENDDOCUMENT();
