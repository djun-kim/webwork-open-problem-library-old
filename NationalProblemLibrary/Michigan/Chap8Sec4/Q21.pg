# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
# ENDDESCRIPTION

## KEYWORDS('calculus', 'integral', 'definite integrals', 'density', 'center of mass', 'area', 'volume')
## Tagged by glr 02/08/09

## DBsubject('Calculus')
## DBchapter('Applications of Integration')
## DBsection('Applications to Physics and Engineering')
## Date('')
## Author('Gavin LaRose')
## Institution('University of Michigan')
## TitleText1('Calculus')
## EditionText1('4')
## EditionText2('5')
## AuthorText1('Hughes-Hallett')
## AuthorText2('Hughes-Hallett')
## Section1('8.4')
## Section2('8.4')
## Problem1('21')
## Problem2('23')

## Textbook tags
## HHChapter1('Using the Definite Integral')
## HHChapter2('Using the Definite Integral')
## HHSection1('Density and Center of Mass')
## HHSection2('Density and Center of Mass')



DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"PGchoicemacros.pl",
"parserNumberWithUnits.pl",
"hhAdditionalMacros.pl",
# "parserFormulaUpToConstant.pl",
# "PGcourse.pl",
);

Context("Numeric");
Context()->flags->set( reduceConstants=>0 );
$showPartialCorrectAnswers = 1;

# we need $a - e^{$x0} > 0
$a = random(3,8,1);

$xmax = int(log($a));
$x0 = random(1,$xmax,1);
$len = 2*$x0;

$s = list_random(0,1) ? "" : "-";

$lr = new_multiple_choice();
$lr->qa("Will the center of mass of the rod beon the left or right " .
	"of the origin?", $s ? "right" : "left");
$lr->extra($s ? "left" : "right");
$lr->makeLast("right");

$xc = Compute("(e^($x0)($x0-1) + e^(-$x0)(1+$x0))/" .
	      "(e^(-$x0) - e^($x0) + 2*$a*$x0)");
$xc = -1*$xc if ( ! $s );

Context("Numeric");

TEXT(beginproblem());
Context()->texStrings;
Context()->texStrings;
BEGIN_TEXT

A rod of length $len meters and density \( \delta(x) = $a -
e^{$s x} \) kilograms per meter is placed on the \( x \)-axis with
its ends at \( x= \pm $x0 \).
$PAR
${BBOLD}(a)${EBOLD}
\{ $lr->print_q \}
\{ $lr->print_a \}
$BR
${BITALIC}(Be sure you can explain why this is the case.)$EITALIC

$PAR
${BBOLD}(b)$EBOLD
Find location of the center of mass.
$BR
\(\overline x = \) \{ ans_rule(25) \}

END_TEXT
Context()->normalStrings;
Context()->normalStrings;

ANS( radio_cmp( $lr->correct_ans() ) );
ANS( $xc->cmp() );

$xmin = $s ? -1*$x0 : $x0;
$xmax = -1*$xmin;

$ao2 = ($a == 2) ? "" : reduced_frac($a,2);
$s2 = $s ? "+" : "-";

$twoax0 = 2*$a*$x0;

$x0p1 = $x0 + 1;  $nx0p1 = -1*$x0p1;
$x0m1 = $x0 - 1;  $nx0m1 = -1*$x0m1;
if ( $x0m1 == 1 ) {
    $x0m1 = ''; $nx0m1 = '-';
}
$mom = $s ? "$x0m1 e^{$x0} + $x0p1 e^{-$x0}" :
    "$nx0m1 e^{$x0} - $x0p1 e^{-$x0}";
if ( $x0 == 1 ) {
    $mom = $s ? "$x0p1 e^{-$x0}" : "-$x0p1 e^{-$x0}";
}

Context()->texStrings;
Context()->texStrings;
SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR

${BBOLD}(a)$EBOLD
The density is minimum at \(x=$xmin\) and increases in the direction
of \(x=$xmax\), so more of the mass of the rod is in the right half
of the rod. We thus expect the balancing point to be to the $side of
the origin.

$PAR
${BBOLD}(b)$EBOLD
We need to compute
\[
   \int_{-$x0}^{$x0}\, x($a - e^{$s x})\,dx
      = \left( $ao2 x^2 $s2 x e^{$s x} + e^{$s x} \right)\bigg|_{-{$x0}}^{$x0},
\]
by using integration by parts.  Evaluating this, we get
\[
   \int_{-$x0}^{$x0}\, x($a - e^{$s x})\,dx = $mom.
\]

We must divide this result by the total mass, which is given by
\[\int_{-$x0}^{$x0} ($a - e^{$s x})\,dx =
    ($a x $s2 e^{$s x})\bigg|_{-$x0}^{$x0} =
    $twoax0 + e^{$x0} - e^{-$x0}.\]
We therefore have
\[\overline{x} = \frac{$mom}{$twoax0 + e^{$x0} - e^{-$x0}}
    \approx  $xc. \]

END_SOLUTION
Context()->normalStrings;
Context()->normalStrings;

ENDDOCUMENT();
