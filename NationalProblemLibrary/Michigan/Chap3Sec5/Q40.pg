# DESCRIPTION
# Problem from Calculus, single variable, Hughes-Hallett et al., 4th ed.
# WeBWorK problem written by Gavin LaRose, <glarose@umich.edu>
# ENDDESCRIPTION

## KEYWORDS('calculus','derivative')
## Tagged by cmd6a 09/05/07

## DBsubject('Calculus')
## DBchapter('Differentiation')
## DBsection('Derivatives of Trigonometric Functions')
## Date('')
## Author('Gavin LaRose')
## Institution('University of Michigan')
## TitleText1('Calculus: Single and Multivariable')
## EditionText1('4')
## AuthorText1('Hughes-Hallett')
## Section1('3.5')
## Problem1('')

DOCUMENT();
loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl",
);
 
TEXT(&beginproblem);
$showPartialCorrectAnswers = 0;

$r = random(3,6,1);
$x0 = random(8,15,1);

$x0r   = $x0**$r;

$sderiv  = cos($x0r);
$sdderiv = ($r-1)*cos($x0r) - $r*$x0r*sin($x0r);

if ( $sderiv == 0 ) {
    $ans1 = 'neither';
    $sol1 = 'zero';  $sg1 = '=';
} else {
    if ( $sderiv > 0 ) {
        $ans1 = 'increasing';
        $sol1 = 'positive';  $sg1 = '>';
    } else {
        $ans1 = 'decreasing';
        $sol1 = 'negative';  $sg1 = '<';
    }
}
if ( $sdderiv == 0 ) {
    $ans2 = 'neither';
    $sg2 = '=';
} else {
    $ans2 = ( $sdderiv > 0 ) ? 'up' : 'down';
    $sans2 = 'concave ' . $ans2;
    $sg2 = ( $sdderiv > 0 ) ? '>' : '<';
}

BEGIN_TEXT

Is the graph of \( y = \sin(x^{$r}) \) 
increasing or decreasing when \( x=$x0 \)?
\{ ans_rule(12) \} (enter ${BBOLD}increasing$EBOLD, 
${BBOLD}decreasing$EBOLD, or ${BBOLD}neither$EBOLD).
$PAR
Is it concave up or concave down?
\{ ans_rule(12) \} (enter ${BBOLD}up$EBOLD, ${BBOLD}down$EBOLD, or
${BBOLD}neither$EBOLD).

END_TEXT


ANS( str_cmp( $ans1 ) );
ANS( str_cmp( $ans2 ) );

$r1 = $r - 1;
$r2 = $r1 - 1;
$rsq = $r*$r;
$rr1 = $r*$r1;
$r1sq = $r1*$r1;

SOLUTION(EV3(<<'END_SOLUTION'));
$PAR SOLUTION $PAR

We begin by taking the derivative of \( y=\sin(x^{$r}) \) and
evaluating at \( x = $x0 \): 
\[ \frac{dy}{dx}=\cos(x^{$r})\cdot $r x^{$r1}. \]

Evaluating \( \cos(($x0)^{$r}) \) on a calculator (in radians) we see
that it is $sol1, so we know that \(\frac{dy}{dx} $sg1 0 \), and
therefore the function is $ans1.

$PAR
Next, we take the second derivative and evaluate it at
\( x=$x0 \).
\[ \frac{d^2y}{dx^2} = $rr1 x^{$r2} \cos(($x0)^{$r}) - 
    $rsq ($x0)^{$r1sq} \sin(($x0)^{$r}).
 \]
The second term in this expression is much larger than the first, so
we can determine its sign to find the sign of \(\frac{d^2y}{dx^2}\): 
\( -\sin(($x0)^{$r}) $sg2 0 \), so the function is $sans2.

END_SOLUTION

ENDDOCUMENT();
