##DESCRIPTION
##  Stewart, Concepts, 5.4, #19
##  Find a derivative of a given integral
##ENDDESCRIPTION

DOCUMENT();        # This should be the first executable line in the problem.

loadMacros(
"PG.pl",
"PGbasicmacros.pl",
"PGchoicemacros.pl",
"PGanswermacros.pl",
"PGauxiliaryFunctions.pl"
);

TEXT(&beginproblem);
$showPartialCorrectAnswers = 1;

my ($a, $b, $c, $d, $answer);
$a= random(2, 9, 1);
$b= random(2, 9, 1);
$c= random(1, 5, 1);
$d= random(1, 5, 1);

TEXT(EV2(<<EOT));
Use part I of the Fundamental Theorem of Calculus to
find the derivative of
\[ g(x)  = \int_{${a}x}^{${b}x} \frac{u+$c}{u-$d} du \]

$BR \{ANS_RULE(1, 35)\} $BR
EOT
##HINT:
## \[ \int_{${a}x}^{${b}x} \frac{u+$c}{u-$d} du =
## \int_{0}^{${b}x} \frac{u+$c}{u-$d} du + \int_{${a}x}^{0} \frac{u+$c}{u-$d} du
##\]
TEXT(EV2(<<EOT));
$BR $BR [NOTE:  Enter a function as your answer.  Make sure that your
syntax is correct, i.e. remember to put all the necessary *, (, ), etc. ]  For more help see: \{ htmlLink("/webwork_system_html/docs/techdescription/pglanguage/availableFunctions.html", "WeBWorK functions")\}
EOT

$answer="$b*($b*x+$c)/($b*x-$d)-$a*($a*x+$c)/($a*x-$d)" ;

&ANS(function_cmp($answer));

$soln_a = $a;
$soln_b = $b;
$soln_c = $c;
$soln_d = $d;

&SOLUTION(EV3(<<'EOT'));

$SOL $BR $BR

The Fundamental Theorem of Calculus, part I, can be found on p.392 of your
textbook.  It says that if
\[ g(x) = \int_a^x f(t) dt \]
then the derivative of \(g(x)\) with respect to \(x\), written
\(\frac{d}{dx} g(x)\) or \(g'(x)\), is equal to \(f(x)\).  Call this
"Fact 1" so that we can refer to it below.  $PAR

Then on p.395, in example 3, we learn that we must use the chain rule if
the upper limit on the integral is not simply \(x\), but a function of \(x\):
\[ \frac{d}{dx} \int_0^u f(t) dt
	= \frac{d}{du} \left( \int_0^u f(t) dt \right) \frac{du}{dx}
	= f(u) \frac{du}{dx} \]
Call this "Fact 2" so that we can refer to it below.  $PAR

Applying that in this particular circumstance, we find
\[
\begin{align*}
f'(x)   &= \frac{d}{dx} \left( \int_{$soln_a x}^{$soln_b x}
		\frac{u+$soln_c}{u-$soln_d} \right)       \\\\
	&= \frac{d}{dx} \left( \int_0^{$soln_b x}
		\frac{u+$soln_c}{u-$soln_d} +
		\int_{$soln_a x}^0 \frac{u+$soln_c}{u-$soln_d} \right) \\\\
	&= \frac{d}{dx} \left( \int_0^{$soln_b x}
		\frac{u+$soln_c}{u-$soln_d} \right)
		- \frac{d}{dx} \left( \int_0^{$soln_a x}
			\frac{u+$soln_c}{u-$soln_d} \right)       \\\\
	&= $soln_b \left(\frac{$soln_b x + $soln_c}
		{$soln_b x - $soln_d}\right)
		- $soln_a \left(\frac{$soln_a x + $soln_c}
			{$soln_a x - $soln_d}\right)  
\end{align*}
\]

By two applications of Fact 2, above

EOT

ENDDOCUMENT();        # This should be the last executable line in the problem.

