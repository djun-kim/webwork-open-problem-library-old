## DESCRIPTION
## Problem from Functions Modeling Change, Connally, et al., 3rd ed.
## WeBWorK problem written by Adam Spiegler <aspiegler@luc.edu>
## ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Functions')
## DBsection('Input and Output')
## KEYWORDS('functions','evaluating','solving','input','output')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('2.1')
## Problem1('36')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
           "extraAnswerEvaluators.pl",
           "PGauxiliaryFunctions.pl",
           "PGgraphmacros.pl"
           );
       
TEXT(beginproblem()); # standard preamble to each problem.


$showPartialCorrectAnswers = 1;

$per = random(70,90,10);
$r = $per/100;
$d_thou = random(70,110,10);
$a_thou = $r*$d_thou;

$a = $a_thou*1000;
$d = $d_thou*1000;
$ans_a = round(($a - 20000)*.0685 + 973);
$diff_a = $a_thou - 20;
$ans_b = "$r x";
$ans_c = "($r x - 20000)*0.0685 + 973";
$d_per = $r*$d_thou;
$diff_d = $d_per - 20;
$ans_d = round(($r*$d-20000)*.0685 +973);

BEGIN_TEXT
Question 36:
$BR $SPACE $BR
New York state income tax is based on taxable income which is part of a person's total income.  The tax owed to the state is calculated using taxable income (not total income).  In 2005, for a single person with a taxable income between ${DOLLAR}20,000 and ${DOLLAR}100,000, the tax owed was ${DOLLAR}973 plus 6.85${PERCENT} of the taxable income over ${DOLLAR}20,000.  Answer the following questions, and DO NOT include any commas in your final answers.
$BR $SPACE $BR

a) Compute the tax owed by a person whose taxable income is ${DOLLAR}$a_thou,000. $SPACE $SPACE \{ ans_rule(15) \} (round to nearest dollar)
$BR $SPACE $BR
b) Consider a lawyer whose taxable income is $per${PERCENT} of her total income, ${DOLLAR}${BITALIC}x${EITALIC}, where $BITALIC x $EITALIC is between ${DOLLAR}60,000 and ${DOLLAR}120,000.  Write a formula for $BITALIC T(x)${EITALIC}, the amount of taxable income (not the tax owed, yet).$BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE \( T(x) = \) \{ ans_rule(30) \}
$BR $SPACE $BR
c) Write a formula for $BITALIC L(x)${EITALIC}, the amount owed by the lawyer in part (b). $BR 
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE \( L(x) = \) \{ ans_rule(30) \}
$BR $SPACE $BR
d) Use $BITALIC L(x) $EITALIC to evaluate the tax liability (amount owed) for \( x = $d_thou ,000 \) and compare your results to part (a).$BR 
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE \( L( $d ) = \) \{ ans_rule(30) \} (round to nearest dollar)

END_TEXT

ANS( num_cmp( $ans_a ) );
ANS( fun_cmp( $ans_b,vars=>'x' ) );
ANS( fun_cmp( $ans_c,vars=>'x' ) );
ANS( num_cmp( $ans_d ) );

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR
$BBOLD SOLUTION $EBOLD
$BR
a) A person whose income is ${DOLLAR}$a_thou,000 will have to pay 6.85${PERCENT} of ($a_thou,000 - 20,000) = ${DOLLAR}$diff_a plus ${DOLLAR}973, so her tax owed is $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE 
\( ($a_thou ,000 - 20,000)(0.0685) + 973 \approx $ans_a \)
$BR $SPACE $BR
b) If her taxable income is $per${PERCENT} of her total income, then $SPACE \( T(x) = $r x \)
$BR $SPACE $BR
c) In order to find a formula for $BITALIC L(x)$EITALIC we take 6.85${PERCENT} of $BITALIC T(x) $EITALIC - 20,000 and add 973: $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE 
\( L(x) = ( T(x) - 20,000)(0.0685) + 973 \) $BR $SPACE $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE 
\( L(x) = ( $r x - 20,000)(0.0685) + 973 \)
$BR $SPACE $BR
d) \( L($d) = ( $r ($d_thou ,000) - 20,000)(0.0685) + 973 \) $BR $SPACE $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE
\( = ( $d_per ,000 - 20,000)(0.685) + 973 \) $BR $SPACE $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE
\( = ( $diff_d )(0.685) + 973 \approx $ans_d \)
$BR
END_SOLUTION
      
ENDDOCUMENT();   # This should be the last executable line in the problem.