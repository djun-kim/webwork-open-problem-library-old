# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Transformations of Functions and Their Graphs')
## DBsection('Horizontal Stretches and Compressions')
## KEYWORDS('reflection','compression','expansion','transformations')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('5.4')
## Problem1('18')
## Author('Adam Spiegler and Paul Pearson')
## Institution('Loyola University Chicago and Fort Lewis College')

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
#           "PGgraphmacros.pl",
#           "extraAnswerEvaluators.pl",
           "PGauxiliaryFunctions.pl",
#           "PGgraphmacros.pl",
           "parserPopUp.pl",
"MathObjects.pl",
"AnswerFormatHelp.pl",
"PGcourse.pl",
           );
       
TEXT(beginproblem()); # standard preamble to each problem.

Context("Numeric")->variables->are(r=>"Real");

$k = random(5,30,5);
$dec = $k/100;
$plus = 1+$dec;

@eqn = ("\( \ $dec f(r) \)", "\( \ f(r+$dec) \)", 
        "\( \ f($k+r) \)", "\( \ f($plus r) \)", "\( \ f(r) + $dec \)");


@index = ("(i)","(ii)","(iii)","(iv)","(v)");
@perm = shuffle(5);
@inv = invert(@perm);
@eqn = @eqn[@perm];
$ans = $index[$inv[3]];

$form = "pi r^2";
$popup = PopUp(["?","(i)","(ii)","(iii)","(iv)","(v)"],$ans);
$plus_sq = $plus**2;
$almost = 100*$plus_sq;
$ans_c = 100*$plus_sq - 100;

$mc = new_multiple_choice();
$mc->qa(
"Which expression represents the area of a circle whose radius is increased by $k${PERCENT}?", 
"\( f($plus r) \)"
);
$mc->extra(
"\( $dec f(r) \)", 
"\( f(r+$dec) \)",
"\( f($k+r) \)", 
"\( f(r) + $dec \)",
);
#$mc->makeLast("None of the above");


BEGIN_TEXT
Let \( A = f(r) \) be the area of a circle of radius \( r \).
$BR
$BR
(a) Write a formula for \( f(r) = \) \{ ans_rule(20) \} 
\{ AnswerFormatHelp("formulas") \}
$BR
$BR
(b) 
\{ $mc->print_q() \}
$BR
\{ $mc->print_a() \}
$BR
(c) By what percent does the area increase if the radius is increased by $k${PERCENT}? 
$BR 
\{ ans_rule(10) \}$PERCENT (round to the nearest 0.01${PERCENT})
\{ AnswerFormatHelp("numbers") \}

END_TEXT

install_problem_grader(~~&std_problem_grader);
$showPartialCorrectAnswers = 0;

ANS(Compute("$form")->cmp() );
ANS(radio_cmp( $mc->correct_ans() ) );
ANS(Real("$ans_c")->cmp(tolerance=>0.006,tolType=>"absolute") );

#ANS(fun_cmp( $form,vars=>'r') );
#ANS($popup->cmp() );
#ANS(num_cmp( $ans_c, tol=>0.006) );


SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
a) \( \ A = f(r) = \pi r^2 \).
$BR $SPACE $BR
b) If the radius is increased by $k${PERCENT} it will be \( \ ($dec)r + r = $plus r \) . $SPACE The appropriate expression is therefore \( \ f($plus r) \) .
$BR $SPACE $BR
c) Since \( \ f($plus r)= \pi ($plus r)^2= $plus_sq ( \pi r^2) \), the new area is the old area multiplied by $plus_sq, or $almost${PERCENT} of the old area.  The area of a circle has therefore increased by  $ans_c${PERCENT}.
$BR
END_SOLUTION


COMMENT('MathObject version');
ENDDOCUMENT();