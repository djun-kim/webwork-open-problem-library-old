# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Compositions, Inverses, And Combinations Of Functions')
## DBsection('Inverse Functions)
## KEYWORDS('inverse','function','inverse function')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('8.2')
## Problem1('44')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
           "PGauxiliaryFunctions.pl",
           "extraAnswerEvaluators.pl"
           );
       
TEXT(beginproblem()); # standard preamble to each problem.

HEADER_TEXT(<<EOF);
<script language="javascript" type="text/javascript">
<!-- //
function unitspopup() {
    var url = "/webwork2_files/units.html";
    var opt = "height=625,width=600,location=no,menubar=no,status=no" +
              "resizable=yes,scrollbars=yes,toolbar=no,";
    window.open(url,'examdata_info',opt).focus();
}
// -->
</script>
EOF


$showPartialCorrectAnswers = 1;

$a = random(10,50,5);
$r = random(0.02,0.1,.02);
$b = 1 - $r;
$h = random(2,5,1);
$q = random(2,8,1);

$factor = $b**(1/$h);
$rd_fact = round($factor*10000)/10000;
$annual = (1-$factor)*100;
$dec = 1-$rd_fact;
$rd_annual = $dec*100;

$quant = $a*$b**($q/$h);
$rd_quant = round($quant*1000)/1000;

$inv = "($h*ln(Q/$a))/ln($b)";
$time = $h*log($q/$a)/log($b);
$rd_time = round($time*1000)/1000;

BEGIN_TEXT
Question 44:
$BR
$SPACE
$BR
Let \( Q = f(t)=$a ($b)^{t/$h} \) be the number of grams of a radioactive substance remaining after \( t \) years.
$BR $SPACE $BR
a) $SPACE What is the initial quantity of the radioactive substance? $SPACE $SPACE \{ ans_rule(10) \} $SPACE (include \{ htmlLink("javascript:unitspopup()","units") \} in your answer)
$BR $SPACE $BR
b) $SPACE What is the annual decay rate of the substance? $SPACE $SPACE \{ ans_rule(15) \} $PERCENT $SPACE (give your answer as a percent rounded to the nearest 0.01${PERCENT})
$BR $SPACE $BR
c) $SPACE Evaluate \( f($q) =  \)  \{ ans_rule(15) \} (Round your answer to at least three decimal places and include \{ htmlLink("javascript:unitspopup()","units") \} in your answer.)
$BR $SPACE $BR
d) Find a formula for \( f^{-1}(Q) = \) \{ ans_rule(30) \} (express your formula in terms of \( Q \) )
$BR $SPACE $BR
e) Evaluate \( f^{-1}($q)  = \) \{ ans_rule(15) \} $SPACE (Round your answer to at least three decimal places and include \{ htmlLink("javascript:unitspopup()","units") \} in your answer.)
$BR
END_TEXT

ANS(num_cmp( $a, units=>"g" ) );
ANS(num_cmp( $annual, tol=>"0.1") );
ANS(num_cmp( $quant, tol=>"0.01", units=>"g"));
ANS(fun_cmp( $inv, vars=>'Q'));
ANS(num_cmp( $time, tol=>"0.01", units=>"yr"));

$per = $r*100;

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
a) $SPACE We have a starting value of $a grams.
$BR 
b) $SPACE The amount of the radioactive substance present decreases by $per$PERCENT every $h years.  In order to compute the annual decay rate we first compute the annual decay factor \( b = $b^{1/$h} \approx $rd_fact \).  Thus the annual decay rate is \( r = 1 - b = 1 - $rd_fact = $dec \) which is approximately $rd_annual${PERCENT}.
$BR
c) $SPACE We have \( f($a) \approx $rd_quant \), meaning that after $q years, there
are approximately $rd_quant grams of the substance remaining.
$BR $SPACE $BR
d) We have $BR
\( \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Q = $a ($b)^{t/$h} \)
$BR
\( \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \frac{Q}{$a} = ($b)^{t/$h} \)
$BR
\( \ \ \ \ \ \  \ln{ \left( \frac{Q}{$a} \right) } =  \left( \frac{t}{$h} \right) \ln{($b)} \)
$BR
\( \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t = \frac{$h \ln{ \left( \frac{Q}{$a} \right)}} {\ln{($b)}} \).
$BR $SPACE $BR
Thus, the inverse function is given by \( f^{-1}(Q) = \frac{$h \ln{ \left( \frac{Q}{$a} \right)}} {\ln{($b)}} \).
$BR $SPACE $BR
e) $SPACE Substituting \( Q=$q \) into the formula from part (d), we see that
\( f^{-1}($q) \approx $rd_time \) meaning that it takes $rd_time years for the
amount of substance remaining to decrease to $q grams.
$BR
END_SOLUTION

ENDDOCUMENT();