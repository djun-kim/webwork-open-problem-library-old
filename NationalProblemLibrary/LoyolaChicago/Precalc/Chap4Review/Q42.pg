# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Logarithmic Functions')
## DBsection('Review Exercises and Problems')
## KEYWORDS('logarithms','log','ln','half-life','double-time','continuous growth rate')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('4.Review')
## Problem1('42')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
           "extraAnswerEvaluators.pl",
           "PGauxiliaryFunctions.pl",
           "PGgraphmacros.pl"
           );
       
TEXT(beginproblem()); # standard preamble to each problem.


$showPartialCorrectAnswers = 1;

$a = random(200,400,10);
$r = random(3,7,1);
$dec = $r/100;
$b = 1 - $dec;
$t = random(5,12,1);
$ans1 = round((1-($b**$t))*10000)/100;
$k = log($b)/log(exp(1));
$k_rd = round($k*10000)/10000;


$checkbox_mc = new_checkbox_multiple_choice();
$checkbox_mc -> qa("What does $BITALIC k${EITALIC} tell you about the leaking 
                    oil?  Select all that apply if more than one statement is
                    true",
                   "Because it is negative, we know the amount of oil in the 
                    tank is decreasing.",
                   "It gives the continuous hourly rate at which oil is leaking.");
$checkbox_mc -> extra("It tells what percent of oil remains after each hour.",
                      "It tells by what percent of oil decays each hour.",
                      "It is the amount that the oil that leaks out each 
                       second.",
                      "Because it is less than one, we know the amount of oil
                       in the tank is decreasing.");
$checkbox_mc -> makeLast("None of the above");

BEGIN_TEXT
Question 42:
$BR $SPACE $BR
Oil leaks from a tank.  At hour $BITALIC t${EITALIC}=0  there are $a gallons of oil in the tank.  Each hour after that, $r$PERCENT of the oil leaks out.
$BR $SPACE $BR
a) What percent of the original $a gallons has leaked out after $t hours? $BR
$SPACE $SPACE $SPACE $SPACE \{ ans_rule(15) \} $PERCENT (round to the nearest 0.01${PERCENT})
$BR $SPACE $BR
b) If \( \ Q(t)=Q_0 e^{kt} \ \) is the quantity of oil remaining after
$BITALIC t $EITALIC hours, find the value of $BITALIC k${EITALIC}.  $BR
$SPACE $SPACE $SPACE $SPACE \( k = \) \{ ans_rule(15) \} $PERCENT (round to 4 decimal places)
$BR $SPACE $BR
c) \{ $checkbox_mc -> print_q \}
$BR
\{ $checkbox_mc -> print_a \}

END_TEXT

ANS( num_cmp( $ans1,tol=>0.006 ) );
ANS( num_cmp( $k_rd,tol=>0.0001 ) );
ANS(checkbox_cmp( $checkbox_mc -> correct_ans ));


$remain = 100-$r;
$k_rate = -round($k_rd*10000)/100;
$b_sq = round($b**2*10000)/10000;
$b_sq_rt = round($b**2*10000)/100;
$dec1 = round(($b**$t)*10000)/10000;
$almost1 = round(($b**$t)*10000)/100;

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR
a) If \( Q(t)=Q_0b^t \) describes the number of gallons left in the tank
after \( t \) hours, then \( Q_0 \), the amount we started with, is $a, and
$BITALIC b${EITALIC}$, the percent left in the tank after 1 hour, is $remain${PERCENT}.  After two hours, \( ($b)($b) = $b^2 \approx $b_sq \) or $b_sq_rt${PERCENT} remains.  After $t hours, \( $b^{$t} \approx $dec1 \) or $almost1${PERCENT} remains.  Thus after $t hours, $ans1${PERCENT} of the original amount has leaked from the tank.
$BR $SPACE $BR
b) Since \( Q_0= $a \), \( Q(t)= $a e^{kt} \).  But we can also define
\( Q(t)=$a ($b)^t \), so 
$BR $SPACE $BR 
\( \ \ \ \ \ \ $a e^{kt} = $a ($b)^t \) $BR
\( \ \ \ \ \ \ e^{kt} = $b^t \) $BR
\( \ \ \ \ \ \ e^k = $b \) $BR
\( \ \ \ \ \ \ \ln{(e^k)} = \ln{($b)} \) $BR
\( \ \ \ \ \ \ k \ \ln{(e)} = \ln {($b)} \) $BR
\( \ \ \ \ \ \ k = \ln{($b)} \approx $k_rd \)
$BR $SPACE $BR
c)  Since $BITALIC k $EITALIC is negative, we know that the value of $BITALIC Q(t) $EITALIC is decreasing by $k_rate${PERCENT} per hour.  Therefore, $BITALIC k $EITALIC is the continuous hourly decay rate.
$BR
END_SOLUTION


ENDDOCUMENT();   # This should be the last executable line in the problem.