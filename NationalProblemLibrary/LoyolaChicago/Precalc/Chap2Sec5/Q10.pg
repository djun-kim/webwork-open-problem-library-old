# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Functions')
## DBsection('Concavity')
## KEYWORDS('functions','concavity','increasing','decreasing')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('2.5')
## Problem1('10')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
#           "PGgraphmacros.pl",
"PGauxiliaryFunctions.pl",
"PGcourse.pl",           );
       
TEXT(beginproblem()); # standard preamble to each problem.


$showPartialCorrectAnswers = 1;

$x[0] = 12;
$dx = random(2,4,1);
for ($i = 1; $i <= 3; $i++){ $x[$i] = $x[$i-1] + $dx};

$y[0] = random(21.1, 21.9, 0.1);
@dy = (random(.11,.16,.01) , random(.28,.35,.01),
          random(.20,.24,.01) , random(.17,.22,.01),
          random(.28,.35,.01) , random(.11,.14,.01) );

$j = random(0,1,1);
for ($i = 0; $i <=2; $i++){
    $y[1+$i] = $y[$i] + $dy[$j+2*$i] };
@ans = ("Concave Up","Concave Down");
if( $j == 0 ){$k=1} else {$k=0};

$mc = new_multiple_choice();
$mc->qa('Based your answers for the rates of change, the function $BITALIC H(x) $EITALIC is', $ans[$j]);
$mc->extra($ans[$k]);
$mc->makeLast('Concave Down','Neither concave up or concave down','Both concave up and concave down');


BEGIN_TEXT

Calculate the successive average rates of change for the function, $BITALIC H(x) $EITALIC in the table below.
$BR
\{ begintable(6) \}
\{ row( "x", @x ) \}
\{ row( "H(x)", @y ) \} 
\{ endtable() \}
$BR
$SAPCE
$BR
(a) The average rate of change over the interval $SPACE \( $x[0] \leq x \leq $x[1] \) is \{ ans_rule(10) \} 
(round your answer to at least 3 decimal places)
$BR
$BR
(b) The average rate of change over the interval $SPACE \( $x[1] \leq x \leq $x[2] \) is \{ ans_rule(10) \}
(round your answer to at least 3 decimal places)
$BR
$BR
(c) The average rate of change over the interval $SPACE \( $x[2] \leq x \leq $x[3]  \) is \{ ans_rule(10) \}
(round your answer to at least 3 decimal places)
$BR
$BR
(d)
\{ $mc->print_q() \}
\{ $mc->print_a() \}

END_TEXT

ANS(num_cmp($dy[0+$j]/$dx,tol=>0.01) );
ANS(num_cmp($dy[2+$j]/$dx,tol=>0.01) );
ANS(num_cmp($dy[4+$j]/$dx,tol=>0.01) );
ANS(radio_cmp($mc->correct_ans));

for ($q = 0; $q <= 2; $q++){
$rate[$q] = round($dy[2*$q+$j]/$dx*100)/100};

@reason = ("The graph will be concave up since the rate of change is increasing as $BITALIC x $EITALIC increases.",
"The graph will be concave down since the rate of change is decreasing as $BITALIC x $EITALIC increases.");

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
a) The rate of change between \( x= $x[0] \) and \( x = $x[1] \) is $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE
\( \frac{\triangle H}{\triangle x} = \frac{$y[1] - $y[0]}{$x[1]-$x[0]}  = \frac{$dy[0+$j]}{$dx} \approx $rate[0] \)
$BR $SPACE $BR
b) The rate of change between \( x= $x[1] \) and \( x = $x[2] \) is $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE
\( \frac{\triangle H}{\triangle x} = \frac{$y[2] - $y[1]}{$x[2]-$x[1]}  = \frac{$dy[2+$j]}{$dx} \approx $rate[1] \)
$BR $SPACE $BR
c) The rate of change between \( x= $x[2] \) and \( x = $x[3] \) is $BR
$SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE $SPACE
\( \frac{\triangle H}{\triangle x} = \frac{$y[3] - $y[2]}{$x[3]-$x[2]}  = \frac{$dy[4+$j]}{$dx} \approx $rate[2] \)
$BR $SPACE $BR
d) $reason[$j]
$BR

END_SOLUTION
      
ENDDOCUMENT();   # This should be the last executable line in the problem.