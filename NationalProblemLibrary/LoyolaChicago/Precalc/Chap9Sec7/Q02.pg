# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Polynomial And Rational Functions')
## DBsection('Fitting Exponentials And Polynomials To Data)
## KEYWORDS('best fit,'exponential regression','polynomial','power regression')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('9.7)
## Problem1('2')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();

loadMacros("PG.pl", 
           "PGbasicmacros.pl",
           "PGanswermacros.pl",
           "PGstandard.pl",
           "extraAnswerEvaluators.pl", 
           "PGauxiliaryFunctions.pl", 
#           "PGgraphmacros.pl", 
           "MathObjects.pl" 
#           "PGchoicemacros.pl" 
          # "parserNumberWithUnits.pl",
          # "parserFormulaWithUnits.pl", 
          # "parserFormulaUpToConstant.pl",
          # "PGcourse.pl",
          );

TEXT(beginproblem());


$showPartialCorrectAnswers = 1;

$actual_a = random(3,7,1);
$actual_p = random(1.3,1.9,.1);


@x = (2,3,4,5);
$n = 4;
for ($i = 0; $i <= $n-1; $i++) {
          $y[$i] = round( $actual_a*$x[$i]**$actual_p*10000)/10000};

$sum_x = 0;
$sum_y = 0;
$sum_prod = 0;
$sum_xsq = 0;
$sum_ysq = 0;

for ($i = 0; $i <= $n-1; $i++){
                             $sum_x = $sum_x + log($x[$i]);
                             $sum_y = $sum_y + log($y[$i]);
                             $sum_prod = $sum_prod + log($x[$i])*log($y[$i]); 
                             $sum_xsq = $sum_xsq + log($x[$i])**2;
                             $sum_ysq = $sum_ysq + log($y[$i])**2};

$b = ($n*$sum_prod - $sum_x * $sum_y)/($n*$sum_xsq - $sum_x**2);
$a = ($sum_y - $sum_x*$b)/$n;
$rd_b = round($b*10000)/10000;
$rd_a = round($a*10000)/10000;
#$b_prime = ($n*$sum_prod - $sum_x * $sum_y)/($n*$sum_ysq - $sum_y**2);
#if ($b >= 0) { $r = ($b*$b_prime)**(1/2)}
#        else { $r = -($b*$b_prime)**(1/2)};
#$rd_r = round($r*10000)/10000;

$initial = round(exp($rd_a)*100)/100;

$power_fit = "$initial x^($rd_b)";
#$power_coef = $rd_r;

BEGIN_TEXT
Question 2:
$BR
$SPACE
$BR
Find a possible formula for the power function \( g(x) \):  
$BR $SPACE $BR
$BCENTER
\{ begintable(5) \}
\{ row ( "$SPACE $SPACE $SPACE $SPACE \( x \)", @x ) \}
\{ row ( "$SPACE $SPACE \( g(x) \)", @y ) \}
\{ endtable() \} 
$ECENTER
$BR
$BR $SPACE $BR
\( f(x) = \) \{ ans_rule(20) \}
$BR
END_TEXT


ANS(fun_cmp( $power_fit, vars=>'x' ) );

#$base = $x[0]**$p;

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
Regression on a calculator returns the power function \( g(x) = $initial x^{$rd_b} \).
$BR
END_SOLUTION


COMMENT('MathObject version');
ENDDOCUMENT();