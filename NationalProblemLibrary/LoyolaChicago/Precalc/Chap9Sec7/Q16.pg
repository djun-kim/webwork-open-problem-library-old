# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Polynomial And Rational Functions')
## DBsection('Fitting Exponentials And Polynomials To Data)
## KEYWORDS('best fit,'exponential regression','polynomial','power regression')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('9.7)
## Problem1('16')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();

loadMacros("PG.pl", 
           "PGbasicmacros.pl",
           "PGanswermacros.pl",
           "PGstandard.pl",
           "extraAnswerEvaluators.pl", 
           "PGauxiliaryFunctions.pl", 
#           "PGgraphmacros.pl", 
           "MathObjects.pl" 
#           "PGchoicemacros.pl" 
          # "parserNumberWithUnits.pl",
          # "parserFormulaWithUnits.pl", 
          # "parserFormulaUpToConstant.pl",
          # "PGcourse.pl",
          );

TEXT(beginproblem());


$showPartialCorrectAnswers = 1;

$actual_a = random(3,7,1);
$actual_p = random(1.3,1.9,.1);

@x = (399, 499, 599, 699, 799 );
@demand =(62, 55, 47, 40, 34);
$n = 5;
for ($i = 0; $i <= $n-1; $i++) {
       $y[$i] = $x[$i]*$demand[$i];
       $y_th[$i] = floor($y[$i]/1000);
       $y_dec[$i] = $y[$i] - $y_th[$i]*1000;
       $y_disp[$i] = "$y_th[$i],$y_dec[$i]";
       if ($y_dec[$i] < 100) { $y_disp[$i] = "$y_th[$i],0$y_dec[$i]"};
       if ($y_dec[$i] < 10) { $y_disp[$i] = "$y_th[$i],00$y_dec[$i]"}};

$quad_fit = "-0.0565p^2 + 72.9981p + 4749.85";
$price = 646;
$revenue = 28328;

BEGIN_TEXT
Question 16:
$BR
$SPACE
$BR
The managers of a furniture store have compiled data showing the daily demand for recliners at various prices.  
$BR 
$BCENTER
\{ begintable(6) \}
\{ row( 'Recliner price (${DOLLAR})', @x ) \}
\{ row( 'Demand (recliners)', @demand ) \}
\{ row( 'Revenue (${DOLLAR})', ans_rule(8), ans_rule(8), ans_rule(8), ans_rule(8), ans_rule(8) ) \} 
\{ endtable() \}
$ECENTER
$BR
a) In the table above, fill in the revenue generated by selling the number of recliners at the corresponding price.  Do not include dollar signs or commas in your answers.
$BR $SPACE $BR

b) Using quadratic regression on your calculator, find the quadratic function for the revenue as a function of the price \( p \) that best fits the data.
$BR
 \( \ \ \ \ R(p) = \) \{ ans_rule(30) \}
$BR $SPACE $BR

c) According to the quadratic function you found in (b), what price should
the store charge for their recliners to maximize revenue? $BR
$SPACE $SPACE $SPACE $SPACE ${DOLLAR}\{ ans_rule(30) \} (do not include commas and round to the nearest dollar)
$BR $SPACE $BR

d) What is the maximum revenue at this price? $BR
$SPACE $SPACE $SPACE $SPACE ${DOLLAR}\{ ans_rule(30) \} (do not include commas and round to the nearest dollar)
$BR
END_TEXT

for ($i = 0; $i <= 4;  $i++){ ANS(num_cmp( $y[$i] ) )};
ANS(fun_cmp( $quad_fit, vars=>'p' ) );
ANS(num_cmp( $price, tol=>'20' ) );
ANS(num_cmp( $revenue, tol=>'200' ) );


SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
a) $BR
$BCENTER
\{ begintable(6) \}
\{ row( 'Recliner price (${DOLLAR})', @x ) \}
\{ row( 'Demand (recliners)', @demand ) \}
\{ row( 'Revenue (${DOLLAR})', @y_disp ) \} 
\{ endtable() \}
$ECENTER
$BR $SPACE $BR
b) Using quadratic regression, we obtain the following formula for revenue,
\( R, \) as a function of the selling price, \( \ \ R(p) = -0.0565p^2 + 72.9981p + 4749.85 \).
$BR $SPACE $BR

c) By using a graphing calculator to zoom in, we see that the price which maximizes revenue is about ${DOLLAR}\( 646  \).
$BR $SPACE $BR

d) The revenue generated at this price is about ${DOLLAR}\( 28,349 \).
$BR

END_SOLUTION


COMMENT('MathObject version');
ENDDOCUMENT();