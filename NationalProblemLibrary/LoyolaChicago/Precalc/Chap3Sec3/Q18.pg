# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Exponential Functions')
## DBsection('Graphs of  Exponential Functions')
## KEYWORDS('exponential functions','graphs of exponential functions')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('3.3')
## Problem1('18')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
#           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
#           "extraAnswerEvaluators.pl",
           "PGauxiliaryFunctions.pl",
"PGcourse.pl",
           );
       
TEXT(beginproblem()); # standard preamble to each problem.


$showPartialCorrectAnswers = 1;
$a = 1013;
#$p = random(1001,1031,2);
#$r = random(11.5,15,.5);
$r = 14;
$dec = $r/100;
$b = 1-$r/100;

$x = random(20,70,5);
$ans_a = round(($a*$b**$x)*1000)/1000;

$y = random(600,950,50);
$ans_b = round(log($y/$a)/log($b)*1000)/1000;

BEGIN_TEXT

The earth's atmospheric pressure, $BITALIC P${EITALIC}, in terms of height above sea level is often modeled by an exponential decay function.  The pressure at sea level is $a millibars and the pressure decreases by $r$PERCENT for every kilometer above sea level.
$BR
$BR
(a) What is the atmospheric pressure at $x km? 
$BR
\{ ans_rule(20) \} millibars
$BR
$BR
(b) Estimate the altitude ${BITALIC}h${EITALIC} at which the atmospheric pressure equals $y millibars.
$BR
\{ ans_rule(20) \} km.

END_TEXT

ANS( num_cmp($ans_a) );
ANS( num_cmp($ans_b) );

$neg_r = 100-$r;
$alt1 = round($b*$a*1000)/1000;

$f = "1013(0.86)^x for x in <-1,6> using color:blue and weight:2";
$g = "$y for x in <-1,6> using color:red and weight:2";
$graph = init_graph(-1,-100,6,1100,'axes'=>[0,0],'ticks'=>[1,1]);
$graph->lb('reset');
$graph->lb(new Label(-.1,$y,$y,'black','right','bottom'));
$graph->lb(new Label($ans_b,$y,"($ans_b,$y)",'black','left','bottom'));
$point = closed_circle( $ans_b,$y, black );
$graph -> stamps($point);
plot_functions( $graph, $f, $g); 


SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
a) Since the pressure decays by $r$PERCENT every km, for every km you increase your altitude, the pressure is $neg_r$PERCENT of what it was previously.  If you start at sea level the pressure is $a millibars.  At 1 km, the pressure is therefore $neg_r$PERCENT of $a, or \( $a \cdot ($b) \approx $alt1 \ \mbox{millibars} \).  If you are at an altitude of 2 km, then the pressure is $neg_r$PERCENT of $alt1, or \( $a \cdot ($b)^2 \).  At $x km the pressure is therefore \( $a \cdot ($b)^{$x} \approx $ans_a \ \mbox{millibars} \).
$BR $SPACE $BR
b)  If we graph the function \( P=1013(0.86)^h \), we can find the value of \( h \) for which \( P= $y \).  One approach is to see where it intersects the line  \( P= $y \). Doing so, you will see that at an altitude of \( h \approx $ans_b \ \mbox{km} \), the atmospheric pressure will have dropped to $y millibars.
$BR $SPACE $BR
$BCENTER
\{ image(insertGraph($graph), width => 250, height => 250, tex_size => 500) \}
$ECENTER
$BR

END_SOLUTION

      
ENDDOCUMENT();   # This should be the last executable line in the problem.