# DESCRIPTION
# Problem from Functions Modeling Change, Connally et al., 3rd ed.
# WeBWorK problem written by Adam Spiegler, <aspiegler@luc.edu>
# ENDDESCRIPTION

## DBsubject('Precalculus')
## DBchapter('Linear Functions and Change')
## DBsection('Fitting Linear Functions to Data')
## KEYWORDS('linear functions','correlatiion coefficient',least squares','regression'')
## TitleText1('Functions Modeling Change')
## EditionText1('3')
## AuthorText1('Connally')
## Section1('1.6')
## Problem1('4')
## Author('Adam Spiegler')
## Institution('Loyola University Chicago')

DOCUMENT();       

loadMacros("PG.pl",
           "PGbasicmacros.pl",
           "PGchoicemacros.pl",
           "PGanswermacros.pl",
           "PGgraphmacros.pl",
           "extraAnswerEvaluators.pl",
           "PGauxiliaryFunctions.pl",
           "PGgraphmacros.pl"
           );
       
TEXT(beginproblem()); # standard preamble to each problem.


$showPartialCorrectAnswers = 1;

@x = (110,105,120,140,100,125,130,105,115,110);
@y = (10,12,8,2,12,10,5,6,13,3);
$n = 10;

for ($i = 0; $i <= 9; $i++){ @dy[$i] = random(-2,2,1)};
$dy[3] = random(-1,2,1);
for ($j = 0; $j <= 9; $j++) { $y[$j] = $y[$j] + $dy[$j]};

$sum_x = 0;
$sum_y = 0;
$sum_prod = 0;
$sum_xsq = 0;
$sum_ysq = 0;

for ($i = 0; $i <= $n-1; $i++){
                             $sum_x = $sum_x + $x[$i];
                             $sum_y = $sum_y + $y[$i];
                             $sum_prod = $sum_prod + $x[$i]*$y[$i]; 
                             $sum_xsq = $sum_xsq + $x[$i]**2;
                             $sum_ysq = $sum_ysq + $y[$i]**2};

$b = ($n*$sum_prod - $sum_x * $sum_y)/($n*$sum_xsq - $sum_x**2);
$a = ($sum_y - $sum_x*$b)/$n;
$rd_b = round($b*10000)/10000;
$rd_a = round($a*10000)/10000;
$b_prime = ($n*$sum_prod - $sum_x * $sum_y)/($n*$sum_ysq - $sum_y**2);
if ($b >= 0) { $r = ($b*$b_prime)**(1/2)}
        else { $r = -($b*$b_prime)**(1/2)};
$rd_r = round($r*10000)/10000;

$line_fit = "$rd_a + $rd_b x";
$line_coef = $rd_r;


BEGIN_TEXT
Question 4:
$BR $SPACE $BR
The table below shows the IQ of ten students and the number of
hours of TV each watches per week.
$BR $SPACE $BR
$BCENTER
\{ begintable(11) \}
\{ row( "IQ", @x) \}
\{ row( "TV", @y) \}
\{ endtable() \}
$ECENTER
$BR
a) Use a calculator or computer to find the least squares regression
line, \( y = mx + b \), where the dependent variable $BITALIC y $EITALIC denotes the number of hours of TV watched as a function of IQ, $BITALIC x${EITALIC}.  Enter the equation for the line below, rounding your values for $BITALIC m $EITALIC and $BITALIC b $EITALIC to 4 decimal places.
$BR
\( \ \ \ \ y = \) \{ ans_rule(35) \}
$BR $SPACE $BR
b) What is the correlation coefficient of the regression line? \( \ r = \) \{ ans_rule(20) \}  (correct to four decimal places)
END_TEXT

ANS( fun_cmp( $line_fit,vars=>'x' ) );
ANS( num_cmp( $line_coef,tol=>0.0001 ) );

SOLUTION(EV3(<<'END_SOLUTION'));
$BR $SPACE $BR 
$BBOLD  SOLUTION $EBOLD
$BR 
Using linear regression we find that the linear function \( y=$rd_a + $rd_b x \) gives a correlation coefficient of \( r= $rd_r \).
$BR
END_SOLUTION
      
ENDDOCUMENT();